

1
00:00:00.506 --> 00:00:10.416 A:middle
[ Applause ]

2
00:00:10.916 --> 00:00:11.076 A:middle
&gt;&gt; James Howard: Whoops.

3
00:00:15.676 --> 00:00:16.556 A:middle
Good morning everyone.

4
00:00:16.906 --> 00:00:19.486 A:middle
Thank you all for
coming at 9:00 a.m. here.

5
00:00:19.596 --> 00:00:21.086 A:middle
I know that's a little
early for programmers

6
00:00:21.156 --> 00:00:22.066 A:middle
or at least it is for me.

7
00:00:22.636 --> 00:00:24.846 A:middle
This is what's new in Map Kit.

8
00:00:25.036 --> 00:00:26.176 A:middle
I'm James Howard.

9
00:00:26.236 --> 00:00:30.916 A:middle
I'm a software engineer on
the Maps Team and let's begin.

10
00:00:31.036 --> 00:00:34.456 A:middle
So, we have a lot to cover here
and I'm going to go quickly.

11
00:00:34.546 --> 00:00:35.606 A:middle
So, hold on to your hats.

12
00:00:36.856 --> 00:00:39.186 A:middle
Our first topic and the
one that I'm most excited

13
00:00:39.186 --> 00:00:42.436 A:middle
about is Map Kit on OS X.

14
00:00:42.936 --> 00:00:46.076 A:middle
[ Applause ]

15
00:00:46.576 --> 00:00:49.756 A:middle
&gt;&gt; We've also got some updates
to Map Kit for the new UI.

16
00:00:50.696 --> 00:00:53.706 A:middle
So, we're going to
talk about that.

17
00:00:53.916 --> 00:00:56.476 A:middle
New Perspectives: We've got
new ways to look at the Map.

18
00:00:56.546 --> 00:00:59.906 A:middle
We've got a 3D mode that
you can use in Map Kit

19
00:01:00.306 --> 00:01:03.646 A:middle
and we've also got the ability
to span around the 180th radian,

20
00:01:03.686 --> 00:01:05.666 A:middle
so these change the way that
you can set the view port

21
00:01:05.666 --> 00:01:05.956 A:middle
on the Map.

22
00:01:06.486 --> 00:01:07.286 A:middle
We're going to discuss that.

23
00:01:08.956 --> 00:01:12.366 A:middle
There's new Overlays
Functionality in iOS 7 and also

24
00:01:12.366 --> 00:01:14.996 A:middle
on Mac OS X and there's
quite a lot of this.

25
00:01:14.996 --> 00:01:19.096 A:middle
There's a ability to put
overlays underneath labels.

26
00:01:19.396 --> 00:01:21.466 A:middle
So, if you have a polyline or
a polygon and you want to put

27
00:01:21.466 --> 00:01:22.986 A:middle
that underneath the
labeling on the Map

28
00:01:23.076 --> 00:01:25.106 A:middle
to enhance readability
you can do that.

29
00:01:25.516 --> 00:01:29.116 A:middle
We've got the ability to do new
tiled overlays so if you have

30
00:01:29.116 --> 00:01:31.856 A:middle
like a raster image pyramid and
you want to place that on top

31
00:01:31.856 --> 00:01:33.406 A:middle
of the Map you can do that.

32
00:01:33.576 --> 00:01:36.706 A:middle
We've got the ability to replace
the built-in Apple Map data

33
00:01:36.706 --> 00:01:38.906 A:middle
with your own data via overlays

34
00:01:39.296 --> 00:01:40.926 A:middle
and we've got a geodesic
polyline.

35
00:01:41.256 --> 00:01:42.926 A:middle
So, that's new to Overlays
Functionality and we're going

36
00:01:42.926 --> 00:01:43.866 A:middle
to get into that
in a little bit.

37
00:01:44.776 --> 00:01:47.886 A:middle
We've got a search API, so
this is for doing local search.

38
00:01:48.346 --> 00:01:52.916 A:middle
So, finding locations via a
query string we can do that now.

39
00:01:54.096 --> 00:01:56.216 A:middle
And we've also got
a Directions API.

40
00:01:57.576 --> 00:02:04.996 A:middle
So, with that outlined let's
talk about Map Kit for OS X.

41
00:02:05.226 --> 00:02:06.996 A:middle
Here it is.

42
00:02:07.226 --> 00:02:10.295 A:middle
We have an NP Map view
and an NS Window running

43
00:02:10.295 --> 00:02:11.216 A:middle
on Mac OS X there.

44
00:02:12.416 --> 00:02:14.106 A:middle
And what are the features?

45
00:02:14.106 --> 00:02:15.546 A:middle
So, it's just like iOS.

46
00:02:15.746 --> 00:02:21.526 A:middle
We managed to get parody between
iOS and Mac OS X for Map Kit.

47
00:02:22.186 --> 00:02:23.426 A:middle
We've got basically
the same API.

48
00:02:23.816 --> 00:02:28.076 A:middle
So, we have MKMapView on OS X
and the difference between it

49
00:02:28.076 --> 00:02:30.196 A:middle
and iOS is basically just
that' it's an NSView.

50
00:02:30.536 --> 00:02:31.556 A:middle
We have all the same things.

51
00:02:31.556 --> 00:02:33.266 A:middle
We have annotations if
you want to put a point

52
00:02:33.266 --> 00:02:34.066 A:middle
of interest on the Map.

53
00:02:34.626 --> 00:02:37.686 A:middle
The Annotation views are NS
views instead of UI views

54
00:02:37.686 --> 00:02:38.896 A:middle
but they are other
otherwise the same.

55
00:02:39.316 --> 00:02:41.326 A:middle
We've got Overlays so you
can put areas of interest

56
00:02:41.326 --> 00:02:43.506 A:middle
on your Map and we've
also got the Local Search

57
00:02:43.506 --> 00:02:45.416 A:middle
and Directions API,
so it's just like OS X

58
00:02:45.936 --> 00:02:47.736 A:middle
or just like iOS on OS X.

59
00:02:48.896 --> 00:02:51.196 A:middle
There are some small
differences in terms of the UI

60
00:02:51.406 --> 00:02:56.206 A:middle
so here we have a window showing
a MapView with Annotation on it.

61
00:02:56.206 --> 00:02:57.256 A:middle
One thing you can notice is

62
00:02:57.256 --> 00:02:59.526 A:middle
in the lower right there
there's a plus and minus

63
00:02:59.586 --> 00:03:01.606 A:middle
and a compass control so you
can use these to interact

64
00:03:01.606 --> 00:03:04.166 A:middle
with the Map via a
mouse and you can show

65
00:03:04.166 --> 00:03:05.176 A:middle
or hide these with a API.

66
00:03:06.766 --> 00:03:08.826 A:middle
And we have this Map
data attribution label

67
00:03:08.826 --> 00:03:09.766 A:middle
in the lower left.

68
00:03:10.016 --> 00:03:13.276 A:middle
This is basically
what you have on iOS.

69
00:03:13.276 --> 00:03:15.596 A:middle
Don't, don't obscure this thing.

70
00:03:15.596 --> 00:03:17.056 A:middle
We need it there
for legal reasons.

71
00:03:18.026 --> 00:03:20.536 A:middle
And the finally the callouts
that call it that says,

72
00:03:20.536 --> 00:03:21.446 A:middle
"Hello World" there on the map.

73
00:03:22.066 --> 00:03:25.926 A:middle
That is on the side so it can be
on either the right or the left

74
00:03:25.926 --> 00:03:27.086 A:middle
where in iOS it's on the top,

75
00:03:27.086 --> 00:03:28.556 A:middle
but otherwise it has
the same functionality.

76
00:03:28.556 --> 00:03:30.616 A:middle
You can set a left
and a right view on it

77
00:03:30.616 --> 00:03:33.566 A:middle
and you can also set
a subtitle on it.

78
00:03:34.796 --> 00:03:37.696 A:middle
The other thing about this
is it's available for apps

79
00:03:37.696 --> 00:03:40.646 A:middle
in the Mac App Store so you have
to code sign it and you have

80
00:03:40.646 --> 00:03:43.176 A:middle
to put this entitlement on
it: com.apple.developer.maps.

81
00:03:43.696 --> 00:03:46.936 A:middle
And you can turn this on via the
Capabilities page in Xcode 5.

82
00:03:47.376 --> 00:03:49.616 A:middle
And the thing I'll say about
this is it's not on in seed one,

83
00:03:49.726 --> 00:03:52.796 A:middle
so you can-- we're not
enforcing this at the moment

84
00:03:52.796 --> 00:03:54.636 A:middle
but in the next seed we
are going to enforce this.

85
00:03:55.096 --> 00:03:56.306 A:middle
So, it's something you
need to be aware of.

86
00:03:56.716 --> 00:03:59.676 A:middle
And with that let's do a
demo and I'm going to invite

87
00:03:59.676 --> 00:04:02.726 A:middle
up Alexander Carlhian up
on stage to do this demo.

88
00:04:03.296 --> 00:04:04.966 A:middle
And you should give him
a big round of applause

89
00:04:05.006 --> 00:04:05.726 A:middle
because if it wasn't

90
00:04:05.726 --> 00:04:07.666 A:middle
for Alexander we wouldn't
have Map Kit on OS X.

91
00:04:08.166 --> 00:04:14.106 A:middle
[ Applause ]

92
00:04:14.606 --> 00:04:15.436 A:middle
&gt;&gt; Alexander Carlhian:
Good morning everyone.

93
00:04:15.546 --> 00:04:17.646 A:middle
My name is Alexander
Carlhian and today I would

94
00:04:17.646 --> 00:04:21.106 A:middle
like to give you an overview of
the main Map Kit APIs on OS X.

95
00:04:21.606 --> 00:04:23.236 A:middle
How many of you have
used Map Kit in iOS?

96
00:04:24.696 --> 00:04:28.526 A:middle
Good, so for you guys this is
going to sound like a refresher,

97
00:04:29.036 --> 00:04:32.066 A:middle
but for the other guys it's
going to be brand new APIs.

98
00:04:32.396 --> 00:04:35.976 A:middle
So, for today let's just pretend
I am a software developer

99
00:04:35.976 --> 00:04:39.756 A:middle
working for a coffee company
that own a few places in Paris

100
00:04:40.206 --> 00:04:42.936 A:middle
and I would like to extend
my existing application

101
00:04:43.266 --> 00:04:44.096 A:middle
to add MapView.

102
00:04:44.456 --> 00:04:45.496 A:middle
So, how do I do that?

103
00:04:46.316 --> 00:04:49.136 A:middle
Well, we can start with
something really easy,

104
00:04:49.656 --> 00:04:54.126 A:middle
just within Xcode we added a
new object called MKMapView.

105
00:04:54.726 --> 00:05:02.496 A:middle
I can just drag it into my
view, resize, simple right?

106
00:05:02.796 --> 00:05:07.096 A:middle
Just, let's just
run-- here it is.

107
00:05:07.656 --> 00:05:09.956 A:middle
I have my window
and my map view.

108
00:05:11.106 --> 00:05:13.546 A:middle
Good, so the next thing I
would like to do I would

109
00:05:13.546 --> 00:05:17.896 A:middle
like to add controls for
zooming, for compass and I would

110
00:05:17.896 --> 00:05:19.706 A:middle
like to set the region to Paris.

111
00:05:20.286 --> 00:05:23.406 A:middle
So, let's start by adding the
compass and the zoom controls.

112
00:05:24.006 --> 00:05:27.016 A:middle
So, this is pretty easy.

113
00:05:27.216 --> 00:05:30.036 A:middle
You can just set shows compass
and shows zoom controls,

114
00:05:30.186 --> 00:05:32.206 A:middle
set the property to
yes and that's it.

115
00:05:32.866 --> 00:05:38.286 A:middle
If you want to set the region
you need to set a coordinate

116
00:05:39.326 --> 00:05:42.206 A:middle
which is a long lat
and set the radius

117
00:05:43.166 --> 00:05:45.286 A:middle
to create an MK coordinate
region.

118
00:05:45.866 --> 00:05:50.516 A:middle
So, the coordinate is a
long lat and the regions is

119
00:05:50.516 --> 00:05:52.576 A:middle
in meters here, so
that's 10 kilometers.

120
00:05:53.026 --> 00:05:56.086 A:middle
And just set the region using
set region on the map view.

121
00:05:57.026 --> 00:05:57.786 A:middle
Let's run again.

122
00:05:58.366 --> 00:06:02.566 A:middle
So you can see Paris.

123
00:06:02.566 --> 00:06:03.716 A:middle
You can see the compass.

124
00:06:03.926 --> 00:06:06.236 A:middle
I can tilt pushing up or down.

125
00:06:06.526 --> 00:06:07.176 A:middle
I can rotate.

126
00:06:07.896 --> 00:06:13.136 A:middle
I can zoom in and
zoom out, good.

127
00:06:13.376 --> 00:06:17.136 A:middle
So, the next thing is to add
pin for each of my coffee place.

128
00:06:18.146 --> 00:06:24.726 A:middle
To do that I create three
instances of MKPoint annotation

129
00:06:25.996 --> 00:06:29.786 A:middle
by setting coordinate,
setting an optional title.

130
00:06:30.766 --> 00:06:32.336 A:middle
I do it for each
of my coffee place

131
00:06:32.736 --> 00:06:35.626 A:middle
and I can add the
annotations on my MapView

132
00:06:35.626 --> 00:06:38.426 A:middle
in a single call
using addAnnotations:.

133
00:06:39.016 --> 00:06:39.766 A:middle
Let's run again.

134
00:06:40.336 --> 00:06:44.986 A:middle
I can see now that I have my
three red pins on the map.

135
00:06:46.466 --> 00:06:47.006 A:middle
That's great.

136
00:06:47.176 --> 00:06:47.786 A:middle
That's great start.

137
00:06:48.966 --> 00:06:51.886 A:middle
Well, you know what I want
to give a distinct look

138
00:06:51.886 --> 00:06:53.836 A:middle
to my application so I like
to customize this red pin

139
00:06:53.886 --> 00:06:55.576 A:middle
to look something else,
something different,

140
00:06:55.916 --> 00:06:57.586 A:middle
remember that is a coffee place.

141
00:06:57.616 --> 00:07:00.956 A:middle
So, I'm going to add
an image to my project.

142
00:07:01.456 --> 00:07:05.536 A:middle
[ Silence ]

143
00:07:06.036 --> 00:07:06.906 A:middle
&gt;&gt; This image.

144
00:07:08.026 --> 00:07:13.256 A:middle
And I'm going to add a subclass
of my MKPinAnnotationView.

145
00:07:13.766 --> 00:07:16.586 A:middle
Called MyAnnotationView

146
00:07:17.166 --> 00:07:20.426 A:middle
and designated initializer
I just call super

147
00:07:21.026 --> 00:07:24.566 A:middle
and load the image and just
set the image and that's it.

148
00:07:24.756 --> 00:07:25.876 A:middle
You just need to set the image.

149
00:07:27.306 --> 00:07:30.946 A:middle
Next thing you need to do is
to actually tell the MapView

150
00:07:30.946 --> 00:07:34.516 A:middle
that you want to use instance
of your custom annotation view.

151
00:07:35.296 --> 00:07:39.016 A:middle
So, first you set the
delegate of your MapView

152
00:07:39.916 --> 00:07:42.306 A:middle
and you implement this
delegate method here.

153
00:07:42.576 --> 00:07:44.206 A:middle
-mapView:viewForAnnotation:.

154
00:07:44.206 --> 00:07:47.376 A:middle
Here you can just
create one more instance

155
00:07:48.166 --> 00:07:49.906 A:middle
of your annotation
view and return it.

156
00:07:50.376 --> 00:07:51.146 A:middle
Alright, let's run.

157
00:07:51.696 --> 00:07:56.446 A:middle
And you can see that the
red pins have been replaced

158
00:07:56.446 --> 00:07:57.326 A:middle
by my image, pretty easy.

159
00:07:57.766 --> 00:08:01.876 A:middle
Alright, so the next step
will be to add a callout.

160
00:08:02.016 --> 00:08:04.996 A:middle
A callout is like a popover that
pops next to the pin annotation.

161
00:08:05.086 --> 00:08:11.336 A:middle
So to do that you in
annotation view you can call

162
00:08:11.916 --> 00:08:14.696 A:middle
-setCanShowCallout: and
set this property to yes.

163
00:08:15.966 --> 00:08:17.666 A:middle
Well, I've changed the image

164
00:08:17.816 --> 00:08:20.116 A:middle
to have a slightly
bigger pin image.

165
00:08:20.386 --> 00:08:23.336 A:middle
So, I need to adjust the
offset of my callouts

166
00:08:23.686 --> 00:08:26.006 A:middle
where the callout would
be anchored on the right

167
00:08:26.006 --> 00:08:28.376 A:middle
and the left by just
creating a point here

168
00:08:29.156 --> 00:08:30.106 A:middle
and setting the offset.

169
00:08:31.356 --> 00:08:34.196 A:middle
So, let's run.

170
00:08:34.395 --> 00:08:37.556 A:middle
If I click on a pin I
can see the callout next

171
00:08:37.556 --> 00:08:39.306 A:middle
to it with my title.

172
00:08:39.885 --> 00:08:43.546 A:middle
That was easy right.

173
00:08:44.576 --> 00:08:47.046 A:middle
Well, I would like to
customize this callout

174
00:08:47.206 --> 00:08:50.236 A:middle
to add accessory views,
maybe add a button,

175
00:08:50.236 --> 00:08:53.096 A:middle
maybe ordering coffee just
by clicking on this button.

176
00:08:53.546 --> 00:08:56.456 A:middle
So, as seen on the
documentation there is a right

177
00:08:56.566 --> 00:09:01.696 A:middle
and left accessory views
so I'm going to use that.

178
00:09:01.906 --> 00:09:07.216 A:middle
I'm creating a left button,
which is size 32 x 32 points.

179
00:09:08.346 --> 00:09:10.176 A:middle
Setting the title,
target an action,

180
00:09:10.496 --> 00:09:15.676 A:middle
same thing on the right is a
button and I set the target

181
00:09:15.746 --> 00:09:18.686 A:middle
and action to call either
the right click method

182
00:09:18.686 --> 00:09:19.866 A:middle
or left click method.

183
00:09:20.476 --> 00:09:23.506 A:middle
I click on run.

184
00:09:24.696 --> 00:09:28.176 A:middle
If I show my callout I can see
now that I have this new button

185
00:09:28.176 --> 00:09:30.986 A:middle
and if I click on it I can see
the action is correctly fired.

186
00:09:31.526 --> 00:09:35.026 A:middle
Well, it's not exactly what
I want for my application.

187
00:09:35.026 --> 00:09:38.286 A:middle
I would like to customize
this callout to be bigger,

188
00:09:38.356 --> 00:09:39.716 A:middle
to show something
a bit different,

189
00:09:40.006 --> 00:09:41.056 A:middle
maybe have a bigger button.

190
00:09:41.886 --> 00:09:43.246 A:middle
So, how do we do that.

191
00:09:43.496 --> 00:09:46.286 A:middle
That's something that you
guys have been asking for iOS

192
00:09:46.396 --> 00:09:48.486 A:middle
and in fact, it has
already been available

193
00:09:48.846 --> 00:09:50.316 A:middle
since the first mission
of the API.

194
00:09:50.316 --> 00:09:52.406 A:middle
Just you need to keep in mind

195
00:09:52.616 --> 00:09:55.566 A:middle
that annotation view is
just a subclass of a view.

196
00:09:55.886 --> 00:09:59.846 A:middle
So, an UIView on iOS
and an NSView on OS X.

197
00:10:00.636 --> 00:10:03.656 A:middle
So, something you can do
is just to add a subview

198
00:10:04.096 --> 00:10:06.406 A:middle
when the pin is selected
and remove it

199
00:10:06.466 --> 00:10:07.526 A:middle
when the pin is unselected.

200
00:10:08.626 --> 00:10:09.816 A:middle
So, I will show you
how to do that.

201
00:10:10.316 --> 00:10:13.176 A:middle
First, I would like to display
an address inside this callout.

202
00:10:13.176 --> 00:10:16.286 A:middle
So, I'm just adding an
annotation model object here,

203
00:10:16.716 --> 00:10:18.746 A:middle
which is the subclass
of MKPointAnnotation.

204
00:10:19.186 --> 00:10:21.776 A:middle
That just going to hold
the address, no code,

205
00:10:22.306 --> 00:10:26.726 A:middle
but in the App Delegate I'm
replacing the MKPointAnnotation

206
00:10:26.926 --> 00:10:30.096 A:middle
with my own, MyAnnotation
instance inside the address

207
00:10:30.096 --> 00:10:32.056 A:middle
for each of my coffee
place here.

208
00:10:32.406 --> 00:10:36.996 A:middle
So, next thing I'm going to do
is to add a view that's going

209
00:10:36.996 --> 00:10:38.926 A:middle
to be displayed on screen
when I click on the pin.

210
00:10:39.916 --> 00:10:42.386 A:middle
So, this is just a
subclass of NSView,

211
00:10:43.436 --> 00:10:45.286 A:middle
just basic -drawRect:
to add a background.

212
00:10:46.786 --> 00:10:48.436 A:middle
The View Controller is
going to load the nib

213
00:10:49.076 --> 00:10:53.546 A:middle
and inside the nib I'm
just binding my annotation.

214
00:10:53.746 --> 00:11:02.256 A:middle
I will show you my annotation
title here and address

215
00:11:03.036 --> 00:11:05.456 A:middle
and just add a button.

216
00:11:06.086 --> 00:11:08.196 A:middle
Well I now have a
custom callout so I would

217
00:11:08.196 --> 00:11:10.016 A:middle
like to disable the
default callout.

218
00:11:10.476 --> 00:11:13.266 A:middle
So, remember we enabled
it in the allocation view,

219
00:11:13.576 --> 00:11:14.876 A:middle
so we're just going
to disable it now

220
00:11:15.106 --> 00:11:17.126 A:middle
by setting canShowCallout to no.

221
00:11:18.306 --> 00:11:22.086 A:middle
And the last part is to actually
implement the -setSelected:

222
00:11:22.086 --> 00:11:24.026 A:middle
method on the annotation view

223
00:11:24.026 --> 00:11:27.816 A:middle
so next time annotation
view is selected is going

224
00:11:28.216 --> 00:11:29.206 A:middle
to call -setSelected:.

225
00:11:29.266 --> 00:11:30.476 A:middle
So, I can just call super

226
00:11:31.046 --> 00:11:37.546 A:middle
and when the pin is selected
I'm just going to set the frame

227
00:11:37.746 --> 00:11:40.916 A:middle
of my callout and
just add the subview.

228
00:11:41.516 --> 00:11:41.976 A:middle
Easy right?

229
00:11:42.496 --> 00:11:46.266 A:middle
And when the pin is unselected,
I want to fade my view

230
00:11:46.266 --> 00:11:49.606 A:middle
and remove my callout
from the MapView.

231
00:11:49.676 --> 00:11:52.796 A:middle
Something you need
to keep in mind is

232
00:11:52.796 --> 00:11:55.306 A:middle
that we are adding a view
outside of the bounds

233
00:11:55.536 --> 00:11:57.576 A:middle
of the annotation
view of the pin.

234
00:11:58.076 --> 00:12:00.996 A:middle
So, we need to override the
-hitTest: method to correct that

235
00:12:01.496 --> 00:12:05.316 A:middle
and to allow click
to be propagated

236
00:12:05.316 --> 00:12:06.736 A:middle
to the button inside my callout.

237
00:12:07.436 --> 00:12:10.106 A:middle
So, I'm going to run
again one more time.

238
00:12:10.686 --> 00:12:12.886 A:middle
I click on a pin.

239
00:12:13.346 --> 00:12:14.306 A:middle
I can see my callout.

240
00:12:14.336 --> 00:12:19.706 A:middle
I can see the title address and
a button and if I click it fades

241
00:12:19.706 --> 00:12:25.346 A:middle
out and if I click
again on a pin et voila!

242
00:12:26.006 --> 00:12:29.466 A:middle
So, thank you that
was my MapKit on OSX.

243
00:12:29.966 --> 00:12:33.306 A:middle
[ Applause ]

244
00:12:33.806 --> 00:12:35.996 A:middle
I'm really thrilled by this
and I'm looking forward

245
00:12:35.996 --> 00:12:38.506 A:middle
to all your applications
using MapKit in OS X.

246
00:12:38.746 --> 00:12:39.036 A:middle
Thank you.

247
00:12:39.336 --> 00:12:39.566 A:middle
James.

248
00:12:40.066 --> 00:12:43.376 A:middle
[ Applause ]

249
00:12:43.876 --> 00:12:44.576 A:middle
&gt;&gt; James Howard:
Thank you Alexander.

250
00:12:46.276 --> 00:12:47.576 A:middle
So, just to recap
what did we see?

251
00:12:48.316 --> 00:12:52.066 A:middle
We saw how to add Map Kit
to a Mac OS X project.

252
00:12:52.566 --> 00:12:54.676 A:middle
We saw how to control user
interaction with the map view

253
00:12:54.676 --> 00:12:56.726 A:middle
by adding those zoom
and compass controls.

254
00:12:57.216 --> 00:12:58.726 A:middle
We saw how to add annotations

255
00:12:58.766 --> 00:13:02.246 A:middle
to the map both the built-in
MKPin annotation view

256
00:13:02.246 --> 00:13:04.586 A:middle
with the red pins and then
the custom annotation views

257
00:13:04.586 --> 00:13:05.246 A:middle
with the coffee pins.

258
00:13:05.246 --> 00:13:08.446 A:middle
And then finally we saw how
to add a custom callout view.

259
00:13:08.746 --> 00:13:10.306 A:middle
So, if you don't like the
built-in one that comes

260
00:13:10.306 --> 00:13:12.556 A:middle
with Map Kit you need a
little more space or whatever

261
00:13:12.556 --> 00:13:14.366 A:middle
to show what you need to
show, you can do that.

262
00:13:14.766 --> 00:13:17.956 A:middle
And that lesson applies
equally well to iOS as Mac OS X.

263
00:13:19.046 --> 00:13:20.036 A:middle
So, that's Mac OS X.

264
00:13:20.276 --> 00:13:23.036 A:middle
Let's talk about
what's new in iOS 7.

265
00:13:23.096 --> 00:13:25.566 A:middle
So, we've got a new UI in iOS 7

266
00:13:25.566 --> 00:13:27.206 A:middle
and there's a new
look for Map Kit.

267
00:13:28.236 --> 00:13:30.496 A:middle
So, the first thing we've
done is we've updated

268
00:13:30.496 --> 00:13:31.266 A:middle
the cartography.

269
00:13:31.666 --> 00:13:33.796 A:middle
You can see what we had
on the left there in iOS 6

270
00:13:34.136 --> 00:13:36.216 A:middle
and what we have on
the right in iOS 7.

271
00:13:36.486 --> 00:13:37.836 A:middle
So, we've improved
the visibility

272
00:13:37.836 --> 00:13:39.766 A:middle
of the roads especially
the major roads there

273
00:13:40.286 --> 00:13:42.416 A:middle
and we've improved the
labeling quite a bit as well,

274
00:13:42.416 --> 00:13:44.046 A:middle
so you have quite a lot
more detail on the map.

275
00:13:44.226 --> 00:13:46.976 A:middle
So, we think this makes
the map a lot more useable.

276
00:13:48.256 --> 00:13:50.436 A:middle
We've also improved
the Hybrid mode

277
00:13:50.796 --> 00:13:52.306 A:middle
so that's the old Hybrid Mode.

278
00:13:52.876 --> 00:13:53.926 A:middle
This is the new Hybrid Mode.

279
00:13:54.576 --> 00:13:56.716 A:middle
I think it's also
a lot more useable.

280
00:13:57.326 --> 00:14:02.756 A:middle
And we've changed the pins; they
look a little bit different.

281
00:14:02.756 --> 00:14:04.036 A:middle
They're a little-- they've
lost a little weight.

282
00:14:04.406 --> 00:14:06.356 A:middle
They're a little brighter
than they were before.

283
00:14:06.356 --> 00:14:08.036 A:middle
But the nice thing about it
is it's the same dimensions

284
00:14:08.036 --> 00:14:08.446 A:middle
as before.

285
00:14:08.446 --> 00:14:10.726 A:middle
So, if you were doing any
math based on the geometry

286
00:14:10.726 --> 00:14:13.406 A:middle
of those pins it's going to
be the same as it was before.

287
00:14:14.016 --> 00:14:17.636 A:middle
The other thing we've got
is we've got a new callout.

288
00:14:17.636 --> 00:14:19.726 A:middle
So, it's this white
callout now instead

289
00:14:19.726 --> 00:14:21.466 A:middle
of the black callout
we had in iOS 6.

290
00:14:22.546 --> 00:14:23.956 A:middle
We've got a new user
location view.

291
00:14:24.066 --> 00:14:27.306 A:middle
So, this is this white dot
with the colored center.

292
00:14:27.306 --> 00:14:29.876 A:middle
And if you've noticed
we have a new property

293
00:14:29.876 --> 00:14:31.626 A:middle
on UIView, which is Tint Color.

294
00:14:32.006 --> 00:14:35.156 A:middle
If you set that on an
MKMapView it will filter down

295
00:14:35.216 --> 00:14:37.626 A:middle
and effect the user location
view and also the callout.

296
00:14:37.626 --> 00:14:43.316 A:middle
So, let's talk about
New Perspectives.

297
00:14:43.696 --> 00:14:48.466 A:middle
We've got some new ways that you
can look at the map in iOS 7.

298
00:14:48.596 --> 00:14:50.866 A:middle
So, you can now span
the 180th meridian.

299
00:14:51.546 --> 00:14:53.386 A:middle
So you can do this
either via touch,

300
00:14:53.386 --> 00:14:56.936 A:middle
you can just start panning West
and pan over the Pacific Ocean

301
00:14:56.936 --> 00:14:58.916 A:middle
or pan East from
Japan and pan over it.

302
00:14:59.276 --> 00:15:01.246 A:middle
And you can also do this
programmatically via API.

303
00:15:01.776 --> 00:15:04.096 A:middle
So, just to look at the code
really quickly how could you

304
00:15:04.096 --> 00:15:04.476 A:middle
do this?

305
00:15:04.806 --> 00:15:06.426 A:middle
One way you could do it is you
could set the centerCoordinate

306
00:15:06.426 --> 00:15:07.026 A:middle
property of the map.

307
00:15:07.516 --> 00:15:10.286 A:middle
So, we'll create a
coordinate at the equator

308
00:15:10.756 --> 00:15:14.696 A:middle
and the 180th meridian
and set that on the map

309
00:15:14.696 --> 00:15:16.246 A:middle
or you can set the
region on the map.

310
00:15:16.246 --> 00:15:18.616 A:middle
Again we'll set the center
of that region to the equator

311
00:15:18.616 --> 00:15:24.786 A:middle
in the 180th meridian and we'll
use 1000 kilometers both East,

312
00:15:24.786 --> 00:15:28.396 A:middle
West, North and South
as the delta there

313
00:15:29.406 --> 00:15:30.576 A:middle
or you can do it by a MapRect.

314
00:15:30.576 --> 00:15:31.666 A:middle
So, those of you
that are familiar

315
00:15:31.666 --> 00:15:33.846 A:middle
with our MapPoint system,

316
00:15:33.916 --> 00:15:37.326 A:middle
which is a projected coordinate
system, which is proportional

317
00:15:37.326 --> 00:15:38.966 A:middle
to screen points relative

318
00:15:38.966 --> 00:15:40.716 A:middle
to the zoom scale you
can do that with MapRect.

319
00:15:40.716 --> 00:15:44.366 A:middle
So, we have MKMapRectWorld
which is the MapRect enclosing

320
00:15:44.726 --> 00:15:46.556 A:middle
that sort of square
world that we have

321
00:15:46.556 --> 00:15:47.646 A:middle
in the projected
coordinate system.

322
00:15:47.836 --> 00:15:51.116 A:middle
But you can actually make
MapRects that intersect that

323
00:15:51.116 --> 00:15:53.396 A:middle
or go outside the bounds of
that and if you want to do that,

324
00:15:53.396 --> 00:15:55.206 A:middle
that's fine and set the
visible MapRect this way

325
00:15:55.206 --> 00:15:56.266 A:middle
and that will work.

326
00:15:56.266 --> 00:15:59.036 A:middle
So, all of these three things
I showed do the same thing

327
00:15:59.036 --> 00:16:01.576 A:middle
and so that's the screenshot
showed on the slide earlier.

328
00:16:02.226 --> 00:16:03.636 A:middle
The other thing you might
want to do is you might want

329
00:16:03.636 --> 00:16:05.526 A:middle
to enclose pins on the map.

330
00:16:05.526 --> 00:16:07.556 A:middle
So, suppose we have this
pin here in Sydney and one

331
00:16:07.556 --> 00:16:10.066 A:middle
in Honolulu and we say oh we
want to show both of these.

332
00:16:10.436 --> 00:16:13.246 A:middle
So, figure out what would
be the region to span those.

333
00:16:13.246 --> 00:16:15.076 A:middle
It's kind of a bit
of a weird edge case.

334
00:16:15.316 --> 00:16:16.746 A:middle
So here's the code to do it.

335
00:16:17.186 --> 00:16:21.056 A:middle
So, suppose we've got two point
annotations, one in Honolulu

336
00:16:21.056 --> 00:16:23.526 A:middle
and one in Sydney and
if you want to look

337
00:16:23.526 --> 00:16:25.036 A:middle
at the longitude value
for each of those right,

338
00:16:25.036 --> 00:16:26.796 A:middle
it's nearly 360 degrees apart.

339
00:16:27.146 --> 00:16:28.526 A:middle
So, if you just naively
said, "Oh,

340
00:16:28.526 --> 00:16:30.546 A:middle
I'm going to calculate
a longitude delta" right

341
00:16:30.546 --> 00:16:32.306 A:middle
by taking my min longitude
and my max longitude

342
00:16:32.306 --> 00:16:36.616 A:middle
and subtracting the two, you'd
get like you know 354 degrees

343
00:16:36.616 --> 00:16:38.656 A:middle
or something like
that, 356 degrees.

344
00:16:38.976 --> 00:16:41.206 A:middle
It would be way more zoomed
out than what you want.

345
00:16:41.396 --> 00:16:44.106 A:middle
So, we have introduced a new
API called showAnnotations

346
00:16:44.106 --> 00:16:45.486 A:middle
and it makes a list
of annotations

347
00:16:45.886 --> 00:16:47.466 A:middle
and it just does the
work to make sure

348
00:16:47.466 --> 00:16:48.396 A:middle
that those are enclosed.

349
00:16:48.786 --> 00:16:49.766 A:middle
So, you get that screenshot.

350
00:16:50.276 --> 00:16:51.266 A:middle
You like that?

351
00:16:51.266 --> 00:16:51.566 A:middle
[ Applause ]

352
00:16:51.566 --> 00:16:51.736 A:middle
Good.

353
00:16:52.236 --> 00:16:54.696 A:middle
[ Applause ]

354
00:16:55.196 --> 00:16:57.316 A:middle
Yea, it's a nice new
convenience that we've got.

355
00:16:58.506 --> 00:16:59.526 A:middle
We've also got 3D.

356
00:17:00.706 --> 00:17:02.096 A:middle
So, you can view maps in 3D.

357
00:17:02.096 --> 00:17:04.455 A:middle
We've got the Space Needle
here that you can view

358
00:17:04.455 --> 00:17:06.715 A:middle
so you can view these
buildings that we've got.

359
00:17:07.046 --> 00:17:10.036 A:middle
It's on by default in iOS
7 and also in Mavericks.

360
00:17:10.356 --> 00:17:12.246 A:middle
So, if you make an MKMap or
you put it in your project

361
00:17:12.246 --> 00:17:14.396 A:middle
or you recompile your
project you're going to have

362
00:17:14.396 --> 00:17:16.526 A:middle
to create users to be able
to enter that via a gesture

363
00:17:16.996 --> 00:17:18.116 A:middle
on those operating systems.

364
00:17:18.476 --> 00:17:21.076 A:middle
And we've got a whole bunch
of APIs for working with 3D,

365
00:17:21.246 --> 00:17:24.126 A:middle
which I'm not going
to cover here.

366
00:17:24.465 --> 00:17:26.236 A:middle
You should go to the
session this afternoon

367
00:17:26.376 --> 00:17:29.536 A:middle
in Pacific Heights at 2:00 p.m.
and see everything about 3D.

368
00:17:29.536 --> 00:17:32.656 A:middle
There's quite a lot to know
and we've got a lot of new APIs

369
00:17:32.656 --> 00:17:35.016 A:middle
around that and it's just too
much to put in this session.

370
00:17:35.046 --> 00:17:36.976 A:middle
So, go to that this
afternoon to learn about 3D.

371
00:17:37.806 --> 00:17:39.186 A:middle
So, let's talk about
what's new in Overlays.

372
00:17:39.996 --> 00:17:42.116 A:middle
So, just to run it
down we've got a new

373
00:17:42.116 --> 00:17:43.556 A:middle
class MKOverlayRenderer.

374
00:17:43.816 --> 00:17:45.166 A:middle
This is used to draw overlays.

375
00:17:45.166 --> 00:17:47.806 A:middle
We're replacing MKOverlayView
with MKOverlayRenderer.

376
00:17:48.726 --> 00:17:52.216 A:middle
We've got a new facility for
putting overlays beneath labels.

377
00:17:52.646 --> 00:17:55.666 A:middle
So, as I mentioned in the
overview earlier this allows you

378
00:17:55.666 --> 00:17:58.176 A:middle
to put your polylines or
polygons underneath the labels

379
00:17:58.176 --> 00:17:59.406 A:middle
and enhance readability
of the map.

380
00:17:59.676 --> 00:18:01.086 A:middle
We've got a geodesic polyline.

381
00:18:01.086 --> 00:18:03.946 A:middle
A geodesic is the shortest path

382
00:18:04.056 --> 00:18:05.856 A:middle
between two points
along a curved surface.

383
00:18:06.136 --> 00:18:07.446 A:middle
So, as this applies
to the Earth it's--

384
00:18:07.776 --> 00:18:09.556 A:middle
you know it follows

385
00:18:09.556 --> 00:18:11.596 A:middle
that shortest path along the
curved surface of the Earth.

386
00:18:12.366 --> 00:18:13.376 A:middle
Why would you want to use this?

387
00:18:13.556 --> 00:18:15.866 A:middle
Probably to show the flight
path that an airplane takes.

388
00:18:15.976 --> 00:18:17.396 A:middle
Airplanes usually
take the shortest path

389
00:18:17.786 --> 00:18:20.026 A:middle
between two points, not
always, but usually they do.

390
00:18:20.716 --> 00:18:22.046 A:middle
We've got MKTileOverlays.

391
00:18:22.046 --> 00:18:23.556 A:middle
So if you've got a
raster image pyramid,

392
00:18:23.556 --> 00:18:25.476 A:middle
you've got your own
map tiles and you want

393
00:18:25.476 --> 00:18:28.136 A:middle
to show those either
on top of or in lieu

394
00:18:28.136 --> 00:18:30.816 A:middle
of Apple's data we can do
that and that works in content

395
00:18:30.816 --> 00:18:32.536 A:middle
with our Map data
replacement APIs.

396
00:18:33.226 --> 00:18:35.296 A:middle
And the last point is
better performance.

397
00:18:35.336 --> 00:18:38.926 A:middle
We rewrote the Overlay system
in iOS 7, so it's going

398
00:18:38.926 --> 00:18:40.226 A:middle
to be faster and
work better for you.

399
00:18:41.626 --> 00:18:42.536 A:middle
So, let's get into it.

400
00:18:42.536 --> 00:18:45.426 A:middle
First topic, MKOverlayRenderer:
What I'd like you

401
00:18:45.426 --> 00:18:48.426 A:middle
to do is replace everywhere
you use MKOverlayView

402
00:18:48.426 --> 00:18:49.356 A:middle
with MKOverlayRenderer.

403
00:18:49.356 --> 00:18:51.106 A:middle
So we have a whole
new class hierarchy

404
00:18:51.106 --> 00:18:53.536 A:middle
under MKOverlayRenderer,
MKPolylineRenderer,

405
00:18:53.536 --> 00:18:55.716 A:middle
MKPolygonRenderer
and MKCircleRenderer

406
00:18:56.186 --> 00:18:59.616 A:middle
and MKTileOverlayRenderer now.

407
00:19:00.146 --> 00:19:02.236 A:middle
And so just switch
from MKOverlayView

408
00:19:02.236 --> 00:19:04.086 A:middle
to MKOverlayRenderer class.

409
00:19:04.436 --> 00:19:06.156 A:middle
MKOverlayRenderer
is lighter weight

410
00:19:06.156 --> 00:19:07.256 A:middle
because it's no longer a view.

411
00:19:07.306 --> 00:19:09.226 A:middle
We didn't really need
the viewness of it

412
00:19:09.666 --> 00:19:13.066 A:middle
and this is the only way to
do overlays on OS X as well.

413
00:19:13.196 --> 00:19:15.426 A:middle
So, find and replace
and fix your errors

414
00:19:15.426 --> 00:19:16.576 A:middle
and it should be
pretty straightforward.

415
00:19:16.786 --> 00:19:20.026 A:middle
The API is basically the same.

416
00:19:20.236 --> 00:19:25.116 A:middle
So, on the topic of putting your
overlays underneath the labels

417
00:19:25.266 --> 00:19:26.856 A:middle
we have two places
you can put them now.

418
00:19:27.276 --> 00:19:29.196 A:middle
You an put them above roads.

419
00:19:29.846 --> 00:19:31.726 A:middle
So this is going to be
directly above the roads,

420
00:19:31.726 --> 00:19:35.106 A:middle
but below everything else,
above the labels, above shields

421
00:19:35.166 --> 00:19:39.876 A:middle
that you see on highways, or
this is below shields you see

422
00:19:39.876 --> 00:19:42.646 A:middle
on highways rather, below point
of interest icons that are

423
00:19:42.646 --> 00:19:43.436 A:middle
on the map an so forth.

424
00:19:43.516 --> 00:19:45.746 A:middle
And there's
MKOverlayLevelAboveLabels,

425
00:19:45.746 --> 00:19:46.896 A:middle
which is what we
traditionally had

426
00:19:46.896 --> 00:19:48.476 A:middle
since I was formerly
introduced to overlays.

427
00:19:48.476 --> 00:19:49.456 A:middle
So, this is the overlay.

428
00:19:49.456 --> 00:19:51.676 A:middle
It's above everything except
for your annotation views.

429
00:19:52.226 --> 00:19:54.826 A:middle
So, just to show what
this looks like here,

430
00:19:55.156 --> 00:19:56.646 A:middle
get out of the way of the thing.

431
00:19:57.246 --> 00:19:59.156 A:middle
So, this is what we had.

432
00:19:59.366 --> 00:20:01.776 A:middle
This is AboveLabels and
then just go ahead and push

433
00:20:01.776 --> 00:20:03.656 A:middle
that underneath and it improves
the readability of the map.

434
00:20:03.656 --> 00:20:05.816 A:middle
You can see the labels on
the streets and the point

435
00:20:05.816 --> 00:20:08.696 A:middle
of interest icons there; they
really stand out a lot better.

436
00:20:09.166 --> 00:20:15.776 A:middle
And just to go through this in a
little more detail this is how--

437
00:20:16.106 --> 00:20:18.276 A:middle
this is sort of how the map
is layered from the ground up.

438
00:20:19.116 --> 00:20:23.336 A:middle
So, initially we had the grid
and then we add in the base map.

439
00:20:23.336 --> 00:20:26.706 A:middle
So, we add in polygons
like parks

440
00:20:26.706 --> 00:20:28.336 A:middle
and so forth, bodies of water.

441
00:20:29.336 --> 00:20:31.886 A:middle
We add in roads and we add
in 2D building footprints

442
00:20:31.886 --> 00:20:32.586 A:middle
where those are available.

443
00:20:33.896 --> 00:20:36.026 A:middle
And then
MKOverlayLevelAboveRoads

444
00:20:36.296 --> 00:20:38.276 A:middle
so we'll go ahead and put this
polyline here on this road.

445
00:20:40.056 --> 00:20:41.286 A:middle
Then we'll add in labeling

446
00:20:41.696 --> 00:20:43.266 A:middle
so you can see those
point of interest icons.

447
00:20:43.296 --> 00:20:45.206 A:middle
The street labels and so
forth come in and they're

448
00:20:45.206 --> 00:20:45.986 A:middle
on top of the overlay.

449
00:20:45.986 --> 00:20:49.566 A:middle
And then we can add an
overlay above those labels.

450
00:20:49.566 --> 00:20:51.746 A:middle
So we'll put the circle in
their above the labels and then

451
00:20:51.746 --> 00:20:56.226 A:middle
if we were to pitch in the 3D
those 3D buildings they push

452
00:20:56.256 --> 00:20:58.626 A:middle
through and they
occlude the overlays.

453
00:20:58.946 --> 00:21:01.296 A:middle
And then finally we'll come back
to 2D and add an annotation view

454
00:21:01.586 --> 00:21:03.296 A:middle
and an annotation view
sits on top of all of that.

455
00:21:04.086 --> 00:21:05.886 A:middle
So, that's the layers
of the map.

456
00:21:06.196 --> 00:21:08.536 A:middle
That's how they fit together.

457
00:21:08.626 --> 00:21:12.126 A:middle
So, in Code suppose we have
an MKPolygon represented

458
00:21:12.126 --> 00:21:14.346 A:middle
in presidio and we have
this new parameter here

459
00:21:14.346 --> 00:21:15.506 A:middle
when we add the overlay level.

460
00:21:15.506 --> 00:21:17.996 A:middle
We can just pass either of
those [inaudible] values there

461
00:21:18.056 --> 00:21:19.086 A:middle
and get it where we want it.

462
00:21:20.016 --> 00:21:20.756 A:middle
So, pretty straight forward.

463
00:21:21.226 --> 00:21:23.746 A:middle
So the geodesic polyline,
here's a screenshot

464
00:21:23.746 --> 00:21:24.496 A:middle
of what this looks like.

465
00:21:24.496 --> 00:21:25.346 A:middle
We have the blue line.

466
00:21:25.736 --> 00:21:28.196 A:middle
This is the shortest
path as the pixel flies.

467
00:21:28.196 --> 00:21:28.886 A:middle
[ Laughter ]

468
00:21:28.886 --> 00:21:33.086 A:middle
And then yea, and then the
red line is the shortest path

469
00:21:33.086 --> 00:21:35.096 A:middle
as the crow flies in
a very long flight

470
00:21:35.536 --> 00:21:37.066 A:middle
to Tokyo from San Francisco.

471
00:21:38.496 --> 00:21:39.756 A:middle
So, in Code how is this done?

472
00:21:40.216 --> 00:21:42.116 A:middle
So, suppose we have a
method here updateOverlays

473
00:21:42.816 --> 00:21:44.536 A:middle
and we're going to
create a geodesic polyline

474
00:21:44.536 --> 00:21:46.156 A:middle
from two points.

475
00:21:46.156 --> 00:21:49.026 A:middle
MKGeodesicPolyline is a
subclass of MKPolyline

476
00:21:49.026 --> 00:21:49.856 A:middle
so it works the same way.

477
00:21:50.136 --> 00:21:52.826 A:middle
We just create it with a list of
coordinates, in this case two.

478
00:21:53.306 --> 00:21:55.566 A:middle
We add it to the map and the
map's going to come back to us

479
00:21:55.566 --> 00:21:57.186 A:middle
and say give me a
renderer for this

480
00:21:57.406 --> 00:21:59.356 A:middle
and we just use a regular
MKPolyline Renderer

481
00:21:59.356 --> 00:21:59.946 A:middle
to show this.

482
00:22:00.246 --> 00:22:02.766 A:middle
And it has a line
with a strokeColor.

483
00:22:02.766 --> 00:22:03.996 A:middle
There's no difference
between the renderer

484
00:22:03.996 --> 00:22:06.536 A:middle
for regular polylines
and geodesic polylines.

485
00:22:06.576 --> 00:22:10.136 A:middle
So, the same thing there.

486
00:22:10.336 --> 00:22:12.676 A:middle
Next topic, MKTileOverlays

487
00:22:12.676 --> 00:22:16.366 A:middle
so this is a full replacement
tile set that I built.

488
00:22:16.756 --> 00:22:19.966 A:middle
I used Core Image and I did
like a CP atone filter and I did

489
00:22:20.106 --> 00:22:22.616 A:middle
like a grid behind it and
so forth and took some tiles

490
00:22:22.776 --> 00:22:24.566 A:middle
and built my own tile set here.

491
00:22:24.946 --> 00:22:28.946 A:middle
So, that's my take
on an old time map.

492
00:22:29.956 --> 00:22:31.256 A:middle
How did I do this?

493
00:22:31.606 --> 00:22:33.126 A:middle
Well, it's pretty simple to use.

494
00:22:33.406 --> 00:22:35.036 A:middle
The first thing you do is
you configure a template.

495
00:22:35.036 --> 00:22:37.236 A:middle
You're also, if you have these
tiles you have an image pyramid,

496
00:22:37.236 --> 00:22:39.356 A:middle
a whole bunch of tiles located
on the web server somewhere.

497
00:22:39.696 --> 00:22:40.946 A:middle
You have some addressing
scheme for it.

498
00:22:41.276 --> 00:22:42.526 A:middle
You fill out this template URL

499
00:22:42.816 --> 00:22:44.046 A:middle
and you have your
[inaudible] parameters

500
00:22:44.046 --> 00:22:45.906 A:middle
or whatever structure
you use to make this URL.

501
00:22:46.386 --> 00:22:49.996 A:middle
There's an X and a Y and a Z
addressing each of those tiles

502
00:22:50.256 --> 00:22:52.016 A:middle
and we'll go ahead
and those are things

503
00:22:52.016 --> 00:22:52.856 A:middle
that are in the braces there.

504
00:22:52.856 --> 00:22:55.636 A:middle
We'll fill those in and so
when you create a tile overlay

505
00:22:55.636 --> 00:22:57.336 A:middle
with that we're going
to take that template

506
00:22:57.646 --> 00:22:59.106 A:middle
and as needed we'll load tiles

507
00:22:59.106 --> 00:23:00.416 A:middle
from your web server
in order to display.

508
00:23:00.916 --> 00:23:03.456 A:middle
We can set this property
canReplaceMapContent to Yes

509
00:23:03.986 --> 00:23:06.046 A:middle
and in the case where
we do that it's going

510
00:23:06.046 --> 00:23:08.126 A:middle
to not load Apple
data or show it.

511
00:23:08.226 --> 00:23:09.846 A:middle
It's going to load
your data and show it

512
00:23:09.846 --> 00:23:13.146 A:middle
so it's a way you can use your
own map content using MKMapView.

513
00:23:13.736 --> 00:23:14.986 A:middle
And then finally we'll
add it to the map.

514
00:23:15.206 --> 00:23:17.616 A:middle
We'll add it AboveLabels because
we're replacing everything

515
00:23:18.696 --> 00:23:19.416 A:middle
and that's how it's done.

516
00:23:19.766 --> 00:23:20.856 A:middle
And then the map is
going to come back to us

517
00:23:20.856 --> 00:23:21.846 A:middle
and give us a renderer.

518
00:23:22.706 --> 00:23:24.236 A:middle
We return an
MKTileOverlayRenderer

519
00:23:24.236 --> 00:23:24.676 A:middle
and return it.

520
00:23:25.646 --> 00:23:27.086 A:middle
So, just to go into
a little more detail

521
00:23:27.086 --> 00:23:28.926 A:middle
about this what is the
coordinate system for this?

522
00:23:29.276 --> 00:23:33.856 A:middle
So, the way that it works
is it's a regular grid.

523
00:23:33.996 --> 00:23:37.206 A:middle
It's a square and it's
tiled from the upper left

524
00:23:37.206 --> 00:23:39.146 A:middle
by default though we
also allow you to tile it

525
00:23:39.146 --> 00:23:40.796 A:middle
from the lower left, so you
can set your origin wherever

526
00:23:40.796 --> 00:23:41.826 A:middle
you like.

527
00:23:42.286 --> 00:23:46.296 A:middle
Well, either of those
two places.

528
00:23:46.296 --> 00:23:49.156 A:middle
And it goes by powers of two
so you have zoom level zero,

529
00:23:49.476 --> 00:23:50.876 A:middle
zoom level one, zoom level two.

530
00:23:51.046 --> 00:23:52.616 A:middle
Here we're looking at zoom
level three, so there's going

531
00:23:52.616 --> 00:23:53.926 A:middle
to be eight tiles
in the X direction,

532
00:23:54.336 --> 00:23:56.656 A:middle
eight tile in the Y direction.

533
00:23:57.716 --> 00:23:59.776 A:middle
And then you zoom in,
zoom level twelve.

534
00:23:59.776 --> 00:24:01.726 A:middle
We have two to the twelve
tiles in the X direction

535
00:24:01.726 --> 00:24:03.346 A:middle
to the twelve tiles
in the Y direction

536
00:24:03.656 --> 00:24:04.486 A:middle
and it's quite a lot more.

537
00:24:04.716 --> 00:24:06.226 A:middle
So, it is quite a lot of data.

538
00:24:06.226 --> 00:24:07.486 A:middle
It's not the kind of thing
that you're just going

539
00:24:07.486 --> 00:24:09.186 A:middle
to ship you know
in you app bundle.

540
00:24:09.186 --> 00:24:10.826 A:middle
If you want to replace the
entire world you're going

541
00:24:10.826 --> 00:24:12.576 A:middle
to have to have a web
server loading this

542
00:24:12.576 --> 00:24:14.206 A:middle
up so you load only the
things that you need.

543
00:24:14.706 --> 00:24:18.526 A:middle
And the other thing to say
about this is the tiles are

544
00:24:18.526 --> 00:24:20.396 A:middle
in this mercator
projection that we use.

545
00:24:20.886 --> 00:24:24.186 A:middle
You can use this
code the EPSG:3857

546
00:24:24.186 --> 00:24:27.046 A:middle
if you're using software to
like warp an image to match.

547
00:24:27.936 --> 00:24:28.986 A:middle
There's various ways
we can do it.

548
00:24:28.986 --> 00:24:30.566 A:middle
I've used the command
line tools that came

549
00:24:30.566 --> 00:24:32.286 A:middle
with the geospatial data
abstraction library.

550
00:24:32.326 --> 00:24:34.006 A:middle
It's an open source
toolkit for working

551
00:24:34.006 --> 00:24:35.786 A:middle
with raster geographical data.

552
00:24:36.106 --> 00:24:38.746 A:middle
I've had good success with
this in the past myself

553
00:24:38.746 --> 00:24:41.006 A:middle
and the other thing I'll say
about it, it's the same system

554
00:24:41.006 --> 00:24:43.666 A:middle
as a lot of like web mapping
parameters if you've used

555
00:24:43.666 --> 00:24:46.156 A:middle
like JavaScript frameworks
for showing your own tiles.

556
00:24:46.796 --> 00:24:49.106 A:middle
It's the same system as
that, so you may be able

557
00:24:49.106 --> 00:24:51.996 A:middle
to use the same tiles
in Map Kit as well

558
00:24:51.996 --> 00:24:52.946 A:middle
as what you use on the web.

559
00:24:53.206 --> 00:24:57.376 A:middle
And on the topic of replacing
Apple data with your data,

560
00:24:57.376 --> 00:24:59.906 A:middle
so we do this either by
optional method on MKOverlay.

561
00:24:59.906 --> 00:25:01.146 A:middle
So, you can make--
if you don't want

562
00:25:01.146 --> 00:25:03.456 A:middle
to use MKTileOverlay you
can just use any MKOverlay,

563
00:25:03.616 --> 00:25:05.016 A:middle
implement this method,
return Yes.

564
00:25:05.586 --> 00:25:08.546 A:middle
And what we'll do is
within the bounding MapRect

565
00:25:08.546 --> 00:25:09.716 A:middle
of that we'll say okay
we're not going to try

566
00:25:09.716 --> 00:25:10.736 A:middle
and load any Apple Map data.

567
00:25:10.736 --> 00:25:12.736 A:middle
We're just going to load
your data, so you'll see grid

568
00:25:12.736 --> 00:25:14.426 A:middle
until your data comes
in and draws.

569
00:25:15.016 --> 00:25:16.176 A:middle
And then it's also available

570
00:25:16.176 --> 00:25:17.826 A:middle
as a settable property
on MKTileOverlay.

571
00:25:18.666 --> 00:25:21.506 A:middle
And as I mentioned neither load
nor draw the Apple Map data

572
00:25:21.506 --> 00:25:22.106 A:middle
when we do this.

573
00:25:22.696 --> 00:25:24.986 A:middle
And you typically
use it above labels,

574
00:25:24.986 --> 00:25:26.376 A:middle
so you're showing this right.

575
00:25:26.376 --> 00:25:27.066 A:middle
We're not showing labels.

576
00:25:27.066 --> 00:25:29.396 A:middle
But one new thing is you
actually can put it above roads

577
00:25:29.606 --> 00:25:32.256 A:middle
and what we'll do in that case
is just load the data necessary

578
00:25:32.256 --> 00:25:32.966 A:middle
to display the labels.

579
00:25:32.966 --> 00:25:35.726 A:middle
So, if you had satellite data
or whatever that you needed

580
00:25:35.726 --> 00:25:38.346 A:middle
to display or something that's
not labeled and you wanted

581
00:25:38.346 --> 00:25:40.866 A:middle
to have like a hybrid mode,
you could use this to do that.

582
00:25:42.096 --> 00:25:44.116 A:middle
So, I'm going to walk over
here to the demo machine

583
00:25:44.116 --> 00:25:45.086 A:middle
and show you a quick demo.

584
00:25:45.626 --> 00:25:48.596 A:middle
And what I'm going to do
actually is recycle a demo

585
00:25:48.866 --> 00:25:55.086 A:middle
that I showed in 2010, but
I'm going to update it.

586
00:25:59.336 --> 00:25:59.576 A:middle
Switch here.

587
00:25:59.576 --> 00:25:59.676 A:middle
[ Silence ]

588
00:25:59.676 --> 00:26:11.166 A:middle
&gt;&gt; Let's shut this down and
let's bring up a new demo.

589
00:26:11.166 --> 00:26:11.666 A:middle
[ Silence ]

590
00:26:11.666 --> 00:26:13.216 A:middle
&gt;&gt; That bigger.

591
00:26:13.296 --> 00:26:16.306 A:middle
So, I wrote this three years ago

592
00:26:16.736 --> 00:26:17.846 A:middle
for Worldwide Development
Conference.

593
00:26:17.846 --> 00:26:19.626 A:middle
Did you guys ever look
at Code three years ago?

594
00:26:21.196 --> 00:26:27.526 A:middle
Yea. What I'm going to do is
open my notes here and this--

595
00:26:28.056 --> 00:26:30.426 A:middle
the thing about this,
let me just build

596
00:26:30.426 --> 00:26:35.446 A:middle
and run it and see what it does.

597
00:26:35.666 --> 00:26:38.986 A:middle
I took this map and I'm
going to zoom in on it here.

598
00:26:39.416 --> 00:26:40.956 A:middle
I got this from the
National Oceanic

599
00:26:40.956 --> 00:26:43.556 A:middle
and Atmospheric Administration's
website three years ago

600
00:26:43.956 --> 00:26:48.486 A:middle
and I cut into the tiles using
GDAL and I have those tiles

601
00:26:48.486 --> 00:26:51.086 A:middle
in my apps resources here.

602
00:26:51.856 --> 00:26:52.446 A:middle
You can see them.

603
00:26:52.826 --> 00:26:56.866 A:middle
It's the thing that's
sliced up into tiles.

604
00:26:57.046 --> 00:26:58.426 A:middle
All of these guys are in there

605
00:26:58.926 --> 00:27:01.176 A:middle
and what this thing does it
just goes ahead and loads them

606
00:27:01.176 --> 00:27:03.046 A:middle
and displays them in
semitransparent fashion

607
00:27:03.676 --> 00:27:04.916 A:middle
on top of satellite tiles.

608
00:27:05.436 --> 00:27:08.496 A:middle
So, this is nice, but the thing
about it was there was kind

609
00:27:08.496 --> 00:27:09.996 A:middle
of a lot of code to do this.

610
00:27:09.996 --> 00:27:11.416 A:middle
I'm not even going
to bother with it.

611
00:27:11.476 --> 00:27:12.556 A:middle
Just scroll through
there, it's a lot.

612
00:27:12.556 --> 00:27:14.426 A:middle
And there was more in there.

613
00:27:15.436 --> 00:27:17.746 A:middle
And it was kind of
complicated and the thing

614
00:27:17.746 --> 00:27:20.626 A:middle
about this is it only works
for pretty much this sample.

615
00:27:20.626 --> 00:27:22.526 A:middle
It's like well if you had
a small amount of tiles

616
00:27:22.526 --> 00:27:23.916 A:middle
in your app you're going
to say okay it works,

617
00:27:24.386 --> 00:27:26.386 A:middle
but it doesn't work
well if you want

618
00:27:26.386 --> 00:27:27.366 A:middle
to load them from a web server.

619
00:27:27.416 --> 00:27:29.166 A:middle
I kind of handwaved
that three years ago.

620
00:27:29.166 --> 00:27:33.166 A:middle
So, we're going to make that
better and the way to do

621
00:27:33.166 --> 00:27:34.936 A:middle
that is I'm just going
to delete everything.

622
00:27:35.046 --> 00:27:37.046 A:middle
[ Laughter ]

623
00:27:37.156 --> 00:27:43.976 A:middle
Just delete, delete,
this-- all this.

624
00:27:44.796 --> 00:27:48.986 A:middle
I'm just going to,
nope, nope, nope.

625
00:27:49.186 --> 00:27:53.186 A:middle
Gone. And instead, what I'm
going to do is I'm going to drag

626
00:27:53.186 --> 00:27:57.676 A:middle
in a new viewDidLoad
and what I'm going

627
00:27:57.676 --> 00:27:59.756 A:middle
to do is I still have these
tiles in my out bundle.

628
00:27:59.756 --> 00:28:01.296 A:middle
It works for me because
I don't have that many.

629
00:28:01.496 --> 00:28:03.736 A:middle
I'm not going to put
them on web server here,

630
00:28:03.736 --> 00:28:05.076 A:middle
but you certainly could.

631
00:28:05.386 --> 00:28:09.056 A:middle
I'm going to set up a template
URL so file URL for this.

632
00:28:09.746 --> 00:28:10.776 A:middle
I'm going to make a TileOverlay.

633
00:28:10.926 --> 00:28:12.546 A:middle
I'm going to say
geometry flipped

634
00:28:12.546 --> 00:28:14.146 A:middle
because the origin
is in the lower left.

635
00:28:14.776 --> 00:28:17.206 A:middle
I'll add that overlay to
the map and I'll release it

636
00:28:17.206 --> 00:28:22.366 A:middle
because it was three years
ago and we didn't have ARC.

637
00:28:23.806 --> 00:28:27.686 A:middle
And we'll have renderer for
overlay, new method here.

638
00:28:27.746 --> 00:28:28.716 A:middle
for overlay.

639
00:28:29.156 --> 00:28:30.436 A:middle
We'll make a
TileOverlayRenderer,

640
00:28:30.436 --> 00:28:34.446 A:middle
set the alpha on it to point
6, return it, build and run.

641
00:28:34.566 --> 00:28:40.446 A:middle
There we go exactly the
same thing and 20 lines

642
00:28:40.446 --> 00:28:46.576 A:middle
of code instead of 200.

643
00:28:46.576 --> 00:28:46.956 A:middle
[ Applause ]

644
00:28:46.956 --> 00:28:49.676 A:middle
Thanks. So, let's
shut this down.

645
00:28:49.676 --> 00:28:51.926 A:middle
Close that, close that.

646
00:28:53.146 --> 00:28:56.236 A:middle
So what did we see?

647
00:28:56.706 --> 00:28:58.416 A:middle
We saw that the tiles can
be bundled with the app.

648
00:28:58.536 --> 00:29:00.306 A:middle
So, in this case we had
a smaller number of tiles

649
00:29:00.306 --> 00:29:01.626 A:middle
and we wanted to put
them in the apps bundle.

650
00:29:01.836 --> 00:29:03.746 A:middle
That's fine or more
likely you're going

651
00:29:03.746 --> 00:29:05.636 A:middle
to have a web server
serving up all of thse tiles

652
00:29:05.636 --> 00:29:06.996 A:middle
so you can download
them from your server.

653
00:29:07.476 --> 00:29:08.616 A:middle
And the other thing to see

654
00:29:08.646 --> 00:29:11.106 A:middle
as a I mentioned we can
replace Apple's Map Data

655
00:29:11.506 --> 00:29:14.046 A:middle
or we can show a topic if
we want to blend data on top

656
00:29:14.046 --> 00:29:15.616 A:middle
or we want to add
Apple's Map Data we can do

657
00:29:15.616 --> 00:29:16.726 A:middle
that using MKTileOverlay.

658
00:29:17.236 --> 00:29:17.746 A:middle
So, that's that.

659
00:29:19.126 --> 00:29:21.736 A:middle
Let's talk about Local
Search, enough of Overlays.

660
00:29:22.386 --> 00:29:25.436 A:middle
So, in Local Search
we've got the ability

661
00:29:25.436 --> 00:29:28.446 A:middle
to find a specific
place by name.

662
00:29:28.716 --> 00:29:30.716 A:middle
So if I search for Mascone
Center West and find that.

663
00:29:31.586 --> 00:29:35.116 A:middle
We can find a list of places
by type such as pizza places.

664
00:29:35.656 --> 00:29:39.076 A:middle
So, this is pizza places near
here or you can find an address.

665
00:29:39.566 --> 00:29:42.326 A:middle
So, if you want to find one
infinite loop Cupertino,

666
00:29:42.326 --> 00:29:42.796 A:middle
California.

667
00:29:42.796 --> 00:29:44.956 A:middle
You can find that; that's
Apple's headquarters.

668
00:29:45.476 --> 00:29:49.256 A:middle
We introduced this
in iOS 6.1 actually,

669
00:29:49.256 --> 00:29:51.266 A:middle
so it came out last fall.

670
00:29:51.266 --> 00:29:53.516 A:middle
We also have it on Mavericks.

671
00:29:54.066 --> 00:29:57.256 A:middle
And I would just like
to take a moment here

672
00:29:57.256 --> 00:29:58.616 A:middle
and compare this with Geocoding.

673
00:29:58.616 --> 00:30:00.706 A:middle
So, we introduced CL
Geocoder a few years ago.

674
00:30:01.036 --> 00:30:03.636 A:middle
And Geocoding is useful
and does something similar

675
00:30:03.636 --> 00:30:04.586 A:middle
but not quite the same.

676
00:30:04.586 --> 00:30:06.576 A:middle
So, I just want to explain
why you would use one

677
00:30:06.576 --> 00:30:07.136 A:middle
and not the other.

678
00:30:07.566 --> 00:30:10.666 A:middle
So, with Geocoding we have the
ability to reverse Geocoding.

679
00:30:10.666 --> 00:30:11.486 A:middle
So this takes a coordinate.

680
00:30:11.486 --> 00:30:12.786 A:middle
You have a latitude
and a longitude pair.

681
00:30:13.156 --> 00:30:14.646 A:middle
You get an address,
a structured address.

682
00:30:14.646 --> 00:30:16.836 A:middle
You can add to address book or
you can format it and display it

683
00:30:16.836 --> 00:30:17.676 A:middle
to the user if you want.

684
00:30:18.776 --> 00:30:19.556 A:middle
So, that's how this works.

685
00:30:19.556 --> 00:30:21.706 A:middle
You drop a pin, find
the coordinate for that,

686
00:30:22.156 --> 00:30:24.306 A:middle
reverse Geocode it, put the
address in the subtitle.

687
00:30:25.206 --> 00:30:26.776 A:middle
Forward Geocoding
takes an address.

688
00:30:26.776 --> 00:30:28.876 A:middle
You have an address
book card and you want

689
00:30:28.876 --> 00:30:29.756 A:middle
to find the coordinate.

690
00:30:30.016 --> 00:30:31.856 A:middle
So, in this example we'll
use the Maps app here,

691
00:30:32.426 --> 00:30:36.396 A:middle
open up our contacts list, find
a contact, find the address,

692
00:30:37.476 --> 00:30:38.816 A:middle
we'll Geocode that,
put a pin on the map.

693
00:30:39.876 --> 00:30:42.196 A:middle
Local Search takes a
free form query string,

694
00:30:42.196 --> 00:30:43.566 A:middle
so this is something
the user types in.

695
00:30:43.566 --> 00:30:45.956 A:middle
I want to find you know
a user UI search bar

696
00:30:45.956 --> 00:30:48.956 A:middle
and a search field, get back
a list of search results.

697
00:30:49.516 --> 00:30:53.836 A:middle
So, search for coffee,
drop the pins.

698
00:30:54.016 --> 00:30:56.086 A:middle
And those search
results are represented

699
00:30:56.086 --> 00:30:57.446 A:middle
by a class called MKMapItem.

700
00:30:57.446 --> 00:30:59.496 A:middle
We've had this around
since I was 6.0

701
00:31:00.026 --> 00:31:03.076 A:middle
and its got a coordinate,
it's got a structured address

702
00:31:03.076 --> 00:31:04.236 A:middle
so you can add it
to address book

703
00:31:04.776 --> 00:31:07.956 A:middle
and if it's a business
we may have its name,

704
00:31:07.956 --> 00:31:09.506 A:middle
its phone number and its URL.

705
00:31:09.856 --> 00:31:11.366 A:middle
So, those may be
available depending

706
00:31:11.436 --> 00:31:13.086 A:middle
on what the search result is.

707
00:31:14.456 --> 00:31:18.206 A:middle
So in Code how this is done is
you create a request object.

708
00:31:18.496 --> 00:31:21.936 A:middle
So, MKLocalSearchRequest and
you set two things on it.

709
00:31:22.156 --> 00:31:23.956 A:middle
First is the query so this
is what the user typed

710
00:31:23.986 --> 00:31:26.786 A:middle
in in the user's language.

711
00:31:27.736 --> 00:31:29.176 A:middle
This is a query and
then the region.

712
00:31:29.576 --> 00:31:30.926 A:middle
So, it's important
to set that region

713
00:31:30.926 --> 00:31:33.016 A:middle
because if you don't
set it and you query

714
00:31:33.016 --> 00:31:35.206 A:middle
for pizza you're not going
to get relevant results.

715
00:31:35.256 --> 00:31:37.336 A:middle
So, if you have a map view
that the user can position

716
00:31:37.936 --> 00:31:39.566 A:middle
or you have some other way

717
00:31:39.566 --> 00:31:41.776 A:middle
of constraining you know
what the search is going

718
00:31:41.776 --> 00:31:44.096 A:middle
to be you need to set
that region in order

719
00:31:44.096 --> 00:31:45.046 A:middle
to get relevant results.

720
00:31:45.336 --> 00:31:46.286 A:middle
So, once we've got that set

721
00:31:46.286 --> 00:31:49.376 A:middle
up we'll create a search
object, MKLocalSearch object.

722
00:31:49.376 --> 00:31:50.486 A:middle
We initialize it with a request.

723
00:31:50.696 --> 00:31:53.416 A:middle
It's one local search
object per request.

724
00:31:53.666 --> 00:31:55.766 A:middle
However, you can create multiple
requests, multiple searches

725
00:31:55.766 --> 00:31:57.166 A:middle
and run them in parallel
if you want.

726
00:31:58.086 --> 00:31:59.906 A:middle
So, once we have that
we'll start it up

727
00:32:00.436 --> 00:32:02.066 A:middle
and we'll specify a
CompletionHandler,

728
00:32:02.066 --> 00:32:04.276 A:middle
which is going to get either
a response or an error.

729
00:32:05.506 --> 00:32:08.966 A:middle
This is called back on the
main queue, asynchronously

730
00:32:09.386 --> 00:32:11.606 A:middle
and in this example I'm just
going to go ahead and loop

731
00:32:11.606 --> 00:32:13.566 A:middle
over those map items,
get their Placemarks

732
00:32:13.566 --> 00:32:15.516 A:middle
which have their coordinates
in it and I'm going

733
00:32:15.516 --> 00:32:18.176 A:middle
to remove any old Placemarks on
the map and add these new ones.

734
00:32:18.176 --> 00:32:20.476 A:middle
So, that's how you can put pins
on the map with Local Search.

735
00:32:21.176 --> 00:32:21.966 A:middle
So, that's Local Search.

736
00:32:21.966 --> 00:32:23.676 A:middle
Let's talk about a
closely related topic,

737
00:32:23.676 --> 00:32:26.856 A:middle
which is directions.

738
00:32:26.926 --> 00:32:30.166 A:middle
So, directions is a new API in
iOS 7 and it's on Mavericks.

739
00:32:30.656 --> 00:32:32.566 A:middle
It's a general purpose
route finding API support

740
00:32:32.566 --> 00:32:34.086 A:middle
in both driving and
walking directions.

741
00:32:34.506 --> 00:32:37.226 A:middle
We've got support for alternate
routes, so if there's more

742
00:32:37.226 --> 00:32:39.706 A:middle
than one good way to get there
and the server knows about it,

743
00:32:39.706 --> 00:32:40.616 A:middle
it can recommend them both.

744
00:32:40.616 --> 00:32:42.646 A:middle
And it also has support
for time estimates,

745
00:32:42.646 --> 00:32:45.426 A:middle
so by default this is based on
the current traffic conditions

746
00:32:45.816 --> 00:32:47.976 A:middle
but you can actually
set a departure date

747
00:32:48.896 --> 00:32:52.336 A:middle
or a desired arrival
time to the future

748
00:32:52.716 --> 00:32:54.886 A:middle
and we can use historical
traffic patterns

749
00:32:54.886 --> 00:32:57.566 A:middle
to estimate what the travel time
is going to be at that point.

750
00:32:58.616 --> 00:33:02.036 A:middle
So, that's the features of
directions and how do we use it.

751
00:33:02.436 --> 00:33:03.746 A:middle
So, suppose we have this
method here and we want

752
00:33:03.746 --> 00:33:05.306 A:middle
to find directions
between two places.

753
00:33:05.966 --> 00:33:06.816 A:middle
It works a lot like search.

754
00:33:06.816 --> 00:33:09.696 A:middle
We make a request object, we
initialize it with a source

755
00:33:09.776 --> 00:33:12.376 A:middle
and destination and
those are MKMapItems.

756
00:33:13.396 --> 00:33:15.146 A:middle
So, you can do a
local search for them

757
00:33:15.146 --> 00:33:16.256 A:middle
or make the up yourself.

758
00:33:16.966 --> 00:33:20.456 A:middle
You do that, create a
directions object and ask it

759
00:33:20.456 --> 00:33:22.656 A:middle
to calculate directions and
its going to come back to you

760
00:33:22.656 --> 00:33:25.266 A:middle
on the main thread
with either an error

761
00:33:25.566 --> 00:33:27.656 A:middle
in which case you probably
want to show like a UI alert

762
00:33:27.656 --> 00:33:29.946 A:middle
or NS alert or do
something with that.

763
00:33:30.506 --> 00:33:33.376 A:middle
Otherwise, you're going
to show the response.

764
00:33:34.166 --> 00:33:36.186 A:middle
And so when I talk about showing
the responsibility there's a lot

765
00:33:36.186 --> 00:33:36.916 A:middle
of things you can do about it.

766
00:33:36.916 --> 00:33:38.226 A:middle
There's a lot of data
in this response.

767
00:33:38.496 --> 00:33:40.846 A:middle
And let's just go through really
quickly what is available.

768
00:33:41.426 --> 00:33:43.776 A:middle
So, we echo back to you
the source and destination.

769
00:33:44.246 --> 00:33:47.726 A:middle
So an example of this is like
if you get directions to a place

770
00:33:47.796 --> 00:33:49.856 A:middle
and you know you put
it at this coordinate

771
00:33:49.856 --> 00:33:52.216 A:middle
but the direction server thinks
oh, you really should arrive

772
00:33:52.216 --> 00:33:53.826 A:middle
at this point because it's
going to be easier to turn

773
00:33:53.826 --> 00:33:54.786 A:middle
into the driveway or whatever.

774
00:33:54.786 --> 00:33:56.646 A:middle
It may move that site, so
you want to look at those.

775
00:33:57.056 --> 00:33:58.896 A:middle
It's going to come back
with a list of routes

776
00:33:59.196 --> 00:34:01.486 A:middle
so each route is going
to have a name to it.

777
00:34:01.616 --> 00:34:03.886 A:middle
So, this is sort of the
name of the way that you go

778
00:34:03.886 --> 00:34:05.876 A:middle
like US 101 South, if
you're getting directions

779
00:34:05.876 --> 00:34:06.846 A:middle
from here down to Cupertino.

780
00:34:06.846 --> 00:34:08.416 A:middle
It's going to give
you a distance.

781
00:34:08.416 --> 00:34:10.525 A:middle
It's going to giving
you any advisory notice

782
00:34:10.565 --> 00:34:11.856 A:middle
like if it requires tolls

783
00:34:11.856 --> 00:34:13.126 A:middle
and you can display
that to the user.

784
00:34:14.016 --> 00:34:16.606 A:middle
There's going to be an expected
travel time and there's going

785
00:34:16.606 --> 00:34:17.946 A:middle
to be the geometry
as a polyline.

786
00:34:18.585 --> 00:34:20.446 A:middle
And also there's going
to be a list of turn

787
00:34:20.446 --> 00:34:22.626 A:middle
by turn instructions,
so these are the steps.

788
00:34:22.795 --> 00:34:24.505 A:middle
And so these are going
to be the instructions,

789
00:34:24.505 --> 00:34:26.126 A:middle
so for instance take exit 11

790
00:34:26.126 --> 00:34:28.896 A:middle
on the De Anza Boulevard would
be one your last steps driving

791
00:34:28.896 --> 00:34:29.926 A:middle
down to Apple Headquarters.

792
00:34:30.406 --> 00:34:32.636 A:middle
There may be a notice on some
of the steps, so you may want

793
00:34:32.636 --> 00:34:34.235 A:middle
to present that in
some special UI.

794
00:34:34.896 --> 00:34:38.146 A:middle
You'll get a distance and you'll
also get a transport type.

795
00:34:38.146 --> 00:34:39.766 A:middle
So, for instance, if you
got directions from here

796
00:34:39.766 --> 00:34:42.156 A:middle
to Coit Tower you can't drive
all the way to Coit Tower.

797
00:34:42.156 --> 00:34:43.636 A:middle
You can drive almost
there and then you got

798
00:34:43.636 --> 00:34:45.386 A:middle
to walk the rest of the way.

799
00:34:45.565 --> 00:34:47.686 A:middle
This step may have a
walking step at the end

800
00:34:47.686 --> 00:34:48.735 A:middle
if you got driving directions.

801
00:34:49.196 --> 00:34:51.136 A:middle
And then the other thing is
you can get the step geometry

802
00:34:51.136 --> 00:34:51.806 A:middle
as a polyline.

803
00:34:51.806 --> 00:34:54.246 A:middle
So, this is basically
the subsequence

804
00:34:54.246 --> 00:34:55.326 A:middle
of that overall geometry.

805
00:34:56.815 --> 00:34:58.906 A:middle
So, suppose we want to display
something like this on the map.

806
00:34:59.296 --> 00:35:00.686 A:middle
Here's the routes
from San Franciso

807
00:35:01.126 --> 00:35:02.646 A:middle
down to Cupertino,
three ways to do it.

808
00:35:03.496 --> 00:35:04.716 A:middle
And here's some code to do that.

809
00:35:05.146 --> 00:35:08.706 A:middle
So, we'll just loop over all
the routes and add an overlay

810
00:35:08.866 --> 00:35:11.416 A:middle
of those polylines for each
of the routes to the map.

811
00:35:11.986 --> 00:35:13.586 A:middle
The other thing you might
want to do is you might want

812
00:35:13.586 --> 00:35:14.396 A:middle
to show it in a table view.

813
00:35:14.846 --> 00:35:19.146 A:middle
So, for instance in California
there is always a way,

814
00:35:19.796 --> 00:35:20.846 A:middle
more than one way to get there.

815
00:35:20.846 --> 00:35:23.776 A:middle
You can take the 280,
you can take the 101,

816
00:35:24.286 --> 00:35:25.396 A:middle
you can take the 880.

817
00:35:25.636 --> 00:35:28.606 A:middle
You've got choices and
if you want to do this,

818
00:35:28.606 --> 00:35:31.006 A:middle
suppose we're the data
source for a table view.

819
00:35:31.006 --> 00:35:34.686 A:middle
And what we'll do is we'll have
this route, so we find the route

820
00:35:34.686 --> 00:35:37.416 A:middle
that we want to show and we'll
set the text of that cell

821
00:35:37.686 --> 00:35:38.586 A:middle
to the name of the route.

822
00:35:39.736 --> 00:35:41.636 A:middle
We have a new class in iOs 7,

823
00:35:41.636 --> 00:35:43.616 A:middle
also in Mavericks that's
a distance formatter.

824
00:35:44.096 --> 00:35:46.136 A:middle
This is an NS formatter
subclass that allows you

825
00:35:46.136 --> 00:35:47.336 A:middle
to format distances according

826
00:35:47.336 --> 00:35:49.776 A:middle
to the user interface
language and locale.

827
00:35:50.316 --> 00:35:52.696 A:middle
So, in the United
States we'll use miles.

828
00:35:52.696 --> 00:35:53.636 A:middle
Elsewhere we'll use kilometers.

829
00:35:53.636 --> 00:35:55.436 A:middle
[ Applause ]

830
00:35:55.436 --> 00:36:01.206 A:middle
Cool. I'm glad you guys liked
that and we'll go ahead and use

831
00:36:01.206 --> 00:36:03.746 A:middle
that distance formatter and
we'll use NS data formatter,

832
00:36:03.746 --> 00:36:06.126 A:middle
which I'm going to handwave
here and then we can show

833
00:36:06.126 --> 00:36:08.086 A:middle
that expected arrival
time in distance.

834
00:36:08.086 --> 00:36:09.566 A:middle
So, that's how we do that.

835
00:36:09.756 --> 00:36:11.066 A:middle
So, I'm going to do
a quick demo here

836
00:36:11.186 --> 00:36:12.946 A:middle
of adding walking
directions to an app.

837
00:36:12.946 --> 00:36:14.736 A:middle
I'm going to recycle
another demo.

838
00:36:15.136 --> 00:36:16.576 A:middle
This is one we showed last year

839
00:36:17.566 --> 00:36:22.136 A:middle
and what it did was it
showed Caltrain directions.

840
00:36:22.386 --> 00:36:27.176 A:middle
And it was really just kind of
a basic app and we just used it

841
00:36:27.176 --> 00:36:29.486 A:middle
to show routing apps in maps.

842
00:36:29.896 --> 00:36:35.856 A:middle
And I'm just going to
build and run this.

843
00:36:35.856 --> 00:36:40.646 A:middle
Get this guy going here.

844
00:36:40.646 --> 00:36:43.356 A:middle
It's really just you know a very
basic just kind of a sample app

845
00:36:44.086 --> 00:36:48.766 A:middle
and it gives Caltrain
directions between two points.

846
00:36:48.906 --> 00:36:51.286 A:middle
And the thing about Caltrian
is it doesn't go to Cupertino.

847
00:36:51.426 --> 00:36:53.226 A:middle
It goes to Sunnyvale.

848
00:36:53.606 --> 00:36:55.456 A:middle
And what we'd like to do is
sort of fill in the gaps.

849
00:36:55.456 --> 00:36:58.246 A:middle
Let's improve this app so we can
have walking directions to get

850
00:36:58.246 --> 00:37:00.046 A:middle
from you know how do we get

851
00:37:00.136 --> 00:37:01.706 A:middle
to the train station
we're departing from

852
00:37:01.706 --> 00:37:03.936 A:middle
and from their arrival
transition how do we get

853
00:37:03.936 --> 00:37:04.666 A:middle
to our destination?

854
00:37:04.826 --> 00:37:10.296 A:middle
So, let's quit that and add
some code and some notes here.

855
00:37:10.626 --> 00:37:15.206 A:middle
So, what I'm going to do--

856
00:37:15.426 --> 00:37:19.516 A:middle
it's a sample application,
but it's kind of big.

857
00:37:19.516 --> 00:37:21.856 A:middle
And we don't need to
understand the whole thing

858
00:37:21.856 --> 00:37:22.856 A:middle
in order to modify it.

859
00:37:22.856 --> 00:37:23.826 A:middle
So, what we have here is the--

860
00:37:23.826 --> 00:37:25.946 A:middle
these are the properties on
this view controller here

861
00:37:25.946 --> 00:37:26.626 A:middle
and it has a route.

862
00:37:26.926 --> 00:37:29.966 A:middle
This route object is an internal
object to this application

863
00:37:30.226 --> 00:37:31.756 A:middle
and it represents
a Caltrain route.

864
00:37:31.796 --> 00:37:33.186 A:middle
So, this is what it has.

865
00:37:33.456 --> 00:37:36.116 A:middle
What I want to add alongside
of this is two MKRoutes

866
00:37:36.116 --> 00:37:38.306 A:middle
that we're going to get
from the Directions API.

867
00:37:38.306 --> 00:37:40.166 A:middle
So, we're going to have
the walking leg one.

868
00:37:40.166 --> 00:37:42.436 A:middle
This is how we get to our
departure train station

869
00:37:43.056 --> 00:37:44.566 A:middle
and walking leg two, which is--

870
00:37:44.926 --> 00:37:46.726 A:middle
this is how we get from
our arrival train station

871
00:37:46.726 --> 00:37:47.916 A:middle
to our final destination.

872
00:37:48.366 --> 00:37:51.456 A:middle
So, add properties for
that and what we're going

873
00:37:51.456 --> 00:37:52.726 A:middle
to do is just scroll down here.

874
00:37:53.276 --> 00:37:56.456 A:middle
And I see this method
here ClearRoute.

875
00:37:56.456 --> 00:37:59.046 A:middle
Obviously we just need
to add some stuff here.

876
00:37:59.106 --> 00:38:02.486 A:middle
So, if we clear that Caltrain
route let's also clear our

877
00:38:02.486 --> 00:38:03.746 A:middle
walking route.

878
00:38:04.676 --> 00:38:10.826 A:middle
That's good and once we've
gotten the route it goes ahead

879
00:38:10.826 --> 00:38:13.446 A:middle
and adds annotations for
the start and the stop

880
00:38:13.446 --> 00:38:17.156 A:middle
and it adds an overlay for
the Caltrain route's polyline.

881
00:38:17.876 --> 00:38:20.866 A:middle
And I'm going to add
those walking polylines.

882
00:38:21.486 --> 00:38:25.016 A:middle
I know we don't have them yet,
but hopefully we will get them

883
00:38:25.016 --> 00:38:27.136 A:middle
and when we do we're going
to want to show them.

884
00:38:27.136 --> 00:38:29.606 A:middle
Another thing I noted about
this is this is using this old

885
00:38:29.766 --> 00:38:31.476 A:middle
overlay, AddOverlay API.

886
00:38:31.476 --> 00:38:33.446 A:middle
It's just going to
add it AboveLabels.

887
00:38:33.446 --> 00:38:41.656 A:middle
Let's put them BelowLabels
while we're in here.

888
00:38:41.656 --> 00:38:41.886 A:middle
[ Silence ]

889
00:38:41.886 --> 00:38:48.666 A:middle
&gt;&gt; There we go, so a
bit of formatting there.

890
00:38:49.646 --> 00:38:51.386 A:middle
And let's go ahead and--

891
00:38:51.606 --> 00:38:54.536 A:middle
I know that we implement
ViewForOverlay in here.

892
00:38:55.316 --> 00:38:58.126 A:middle
This is old and busted, delete.

893
00:39:00.096 --> 00:39:04.156 A:middle
New, RendererForOverlay.

894
00:39:04.456 --> 00:39:05.596 A:middle
So the only difference
here is we're going

895
00:39:05.596 --> 00:39:07.926 A:middle
to make polyline renderers
and we'll do a blue one

896
00:39:08.186 --> 00:39:10.876 A:middle
if the polyline that
we're being asked for,

897
00:39:10.876 --> 00:39:13.036 A:middle
the overlay we're being asked
for is for the Caltrain route.

898
00:39:13.036 --> 00:39:14.506 A:middle
Otherwise, it's one
of the walking routes.

899
00:39:14.506 --> 00:39:15.316 A:middle
Let's do a gray line.

900
00:39:15.636 --> 00:39:16.356 A:middle
So, we'll put that in there.

901
00:39:16.436 --> 00:39:19.686 A:middle
And then the last thing is the
thing we're all here to see.

902
00:39:20.066 --> 00:39:24.676 A:middle
There's this method
route from place in here.

903
00:39:25.296 --> 00:39:27.566 A:middle
So, this is an internal
object representing a place.

904
00:39:27.606 --> 00:39:30.386 A:middle
This is where we're
going to start leaving

905
00:39:30.386 --> 00:39:32.856 A:middle
from and where it goes to.

906
00:39:32.856 --> 00:39:35.506 A:middle
And what this application did is
it just said give me the closest

907
00:39:35.506 --> 00:39:38.066 A:middle
stop, the closest stop.

908
00:39:38.356 --> 00:39:39.266 A:middle
Well, how do we get there?

909
00:39:39.896 --> 00:39:41.206 A:middle
Don't know; this
app doesn't do that.

910
00:39:41.206 --> 00:39:43.556 A:middle
And then it just routes from
the start stop to the end stop.

911
00:39:44.066 --> 00:39:45.266 A:middle
Let's not do that.

912
00:39:45.546 --> 00:39:50.186 A:middle
Let's delete that and add this
code, just kind of a big block

913
00:39:50.186 --> 00:39:52.976 A:middle
of code and I'll walk you
through it really quickly.

914
00:39:53.116 --> 00:39:55.206 A:middle
So, we're going to make
a directions request

915
00:39:55.476 --> 00:39:56.236 A:middle
for the first leg.

916
00:39:56.306 --> 00:40:00.026 A:middle
We're going to set the transport
type to walking and we're going

917
00:40:00.026 --> 00:40:01.196 A:middle
to set the source
and the destination

918
00:40:01.196 --> 00:40:02.836 A:middle
to be the start place,
so this is

919
00:40:02.916 --> 00:40:04.856 A:middle
where we're actually
departing from where we are now

920
00:40:04.856 --> 00:40:08.186 A:middle
and then we're going to
set it to the train station

921
00:40:08.186 --> 00:40:09.156 A:middle
that we want to leave from.

922
00:40:09.346 --> 00:40:12.846 A:middle
So, we'll create a
directions object for that.

923
00:40:12.846 --> 00:40:15.106 A:middle
Ask it to calculate directions
and it's going to come back

924
00:40:15.106 --> 00:40:17.746 A:middle
to us on the main queue
and either we're going

925
00:40:17.746 --> 00:40:19.466 A:middle
to be having an error in
which case we're going to have

926
00:40:19.466 --> 00:40:21.856 A:middle
to display an alert and we're
all going to be very sad

927
00:40:22.676 --> 00:40:25.076 A:middle
or we'll get back a walking leg.

928
00:40:25.076 --> 00:40:27.236 A:middle
So, this is-- we didn't
ask for alternate routes,

929
00:40:27.236 --> 00:40:28.236 A:middle
so there's going to be just one.

930
00:40:28.826 --> 00:40:30.136 A:middle
So, we'll get that first route

931
00:40:30.526 --> 00:40:31.976 A:middle
and we'll stash in
that property.

932
00:40:32.586 --> 00:40:38.426 A:middle
So, we'll do the same thing for
leg two and hopefully we succeed

933
00:40:38.786 --> 00:40:39.926 A:middle
and we end up stashing it there

934
00:40:40.846 --> 00:40:42.786 A:middle
and then finally we can get
the Caltrain directions now

935
00:40:42.786 --> 00:40:44.216 A:middle
that we've got the walking
directions that we need.

936
00:40:44.396 --> 00:40:46.406 A:middle
And the thing I'll say
about this is for simplicity

937
00:40:46.406 --> 00:40:48.446 A:middle
up here I've done
these serially.

938
00:40:48.446 --> 00:40:50.256 A:middle
You could run them in
parallel if you want.

939
00:40:50.256 --> 00:40:52.386 A:middle
There's no reason that
you can't do that.

940
00:40:52.386 --> 00:40:53.676 A:middle
I just did it this
way to be simple.

941
00:40:53.676 --> 00:40:55.226 A:middle
So, let's just build and run.

942
00:40:55.226 --> 00:40:55.296 A:middle
[ Silence ]

943
00:40:55.296 --> 00:40:55.646 A:middle
Directions.

944
00:40:59.776 --> 00:41:01.566 A:middle
And the other thing I would say

945
00:41:01.566 --> 00:41:04.036 A:middle
about this is I actually
cheated a little bit and I went

946
00:41:04.036 --> 00:41:05.536 A:middle
and I updated this
sample I had this time

947
00:41:05.536 --> 00:41:08.716 A:middle
to use LocalSearch instead
of using the Geocoder,

948
00:41:08.716 --> 00:41:09.466 A:middle
which it originally is.

949
00:41:09.846 --> 00:41:13.346 A:middle
So, we can actually go from
Mascone West now and let's go

950
00:41:13.346 --> 00:41:15.346 A:middle
to a place in Palo
Alto that I know

951
00:41:15.346 --> 00:41:17.246 A:middle
about called Antonio's Nuthouse.

952
00:41:17.716 --> 00:41:23.326 A:middle
Get directions, and
now if we zoom

953
00:41:23.326 --> 00:41:26.646 A:middle
in on the map we can see
we've got walking directions

954
00:41:26.686 --> 00:41:29.636 A:middle
from Mascone West here,
walk down 4th Street;

955
00:41:29.636 --> 00:41:32.456 A:middle
it's not a long walk, get on
the Caltrain at 4th and King,

956
00:41:33.456 --> 00:41:39.266 A:middle
zoom out, go down and
we'll get off in Palo Alto

957
00:41:39.266 --> 00:41:42.416 A:middle
at the [inaudible] Station
and it's just a short block

958
00:41:42.416 --> 00:41:44.626 A:middle
and a half walk to the
Nuthouse, which is right here.

959
00:41:45.926 --> 00:41:48.136 A:middle
So, that's how you can
add walking directions

960
00:41:48.136 --> 00:41:49.586 A:middle
to an existing routing app.

961
00:41:50.936 --> 00:41:53.196 A:middle
And this is really just kind of
scratching the surface of it.

962
00:41:53.196 --> 00:41:54.576 A:middle
[ Applause ]

963
00:41:54.576 --> 00:41:54.836 A:middle
Thank you.

964
00:41:59.136 --> 00:42:00.856 A:middle
There's obviously a lot
more you could do with it.

965
00:42:00.856 --> 00:42:02.326 A:middle
This just sort of
scratches the surface

966
00:42:02.366 --> 00:42:04.276 A:middle
but I hope you get
the idea there.

967
00:42:06.006 --> 00:42:07.036 A:middle
Let's go back to the slides.

968
00:42:09.906 --> 00:42:11.386 A:middle
So, we saw how to use
the Directions API

969
00:42:11.446 --> 00:42:13.236 A:middle
to augment an existing
routing app.

970
00:42:13.236 --> 00:42:15.376 A:middle
So, I hope that if you have a
routing app right now you have

971
00:42:15.376 --> 00:42:16.886 A:middle
something on there
stored and you say oh,

972
00:42:16.886 --> 00:42:18.166 A:middle
I wish I had walking directions.

973
00:42:18.166 --> 00:42:18.876 A:middle
I wish I could add this.

974
00:42:19.256 --> 00:42:20.286 A:middle
Please go ahead and do that

975
00:42:20.726 --> 00:42:22.286 A:middle
and then the other
thing we saw is how

976
00:42:22.286 --> 00:42:24.046 A:middle
to show those MKRoutes
on MKMapView.

977
00:42:25.116 --> 00:42:25.656 A:middle
So, that's that.

978
00:42:26.076 --> 00:42:27.926 A:middle
So, now I want to talk about
the fact that Directions

979
00:42:27.976 --> 00:42:29.316 A:middle
and Search are server-based.

980
00:42:29.426 --> 00:42:31.476 A:middle
So, they require a network
connection to operate.

981
00:42:32.266 --> 00:42:33.236 A:middle
And the other thing I'll say

982
00:42:33.236 --> 00:42:34.896 A:middle
about them is don't cache
the results for too long.

983
00:42:34.896 --> 00:42:38.336 A:middle
If you get driving directions
and you hold onto them

984
00:42:38.336 --> 00:42:40.216 A:middle
for a week, you know
you store them on disk,

985
00:42:40.546 --> 00:42:42.346 A:middle
you pull those back up,
things may have changed.

986
00:42:42.346 --> 00:42:43.836 A:middle
The traffic conditions
may have changed.

987
00:42:44.286 --> 00:42:46.126 A:middle
There may be a road closure
or something like that.

988
00:42:46.126 --> 00:42:47.476 A:middle
So, you want to rerequest
those things

989
00:42:47.546 --> 00:42:48.336 A:middle
to get more up to date data.

990
00:42:48.336 --> 00:42:49.756 A:middle
And the same thing goes
for Search as well.

991
00:42:51.086 --> 00:42:52.056 A:middle
And the other thing
I want to talk

992
00:42:52.056 --> 00:42:55.626 A:middle
about is the Usage
Limits on this API.

993
00:42:55.866 --> 00:42:58.676 A:middle
So, I'm happy to announce
that there's no application

994
00:42:58.676 --> 00:43:00.566 A:middle
or developer identifier
wide usage limits.

995
00:43:00.776 --> 00:43:03.576 A:middle
So, if you have a app that has
a lot of users and you want

996
00:43:03.576 --> 00:43:05.396 A:middle
to do a lot of requests,
that's fine.

997
00:43:05.576 --> 00:43:05.946 A:middle
It'll work.

998
00:43:06.446 --> 00:43:11.036 A:middle
[ Applause ]

999
00:43:11.536 --> 00:43:14.796 A:middle
And the throttling that we do
have is really just a first line

1000
00:43:14.796 --> 00:43:15.756 A:middle
of defense against buggy apps.

1001
00:43:15.756 --> 00:43:18.646 A:middle
So, if you put directions
requests

1002
00:43:18.646 --> 00:43:21.316 A:middle
or local search requests in an
infinite loop, you've got a bug,

1003
00:43:21.686 --> 00:43:23.016 A:middle
eventually you're
going to get throttled.

1004
00:43:23.276 --> 00:43:24.926 A:middle
But if you do something
reasonable, you say oh,

1005
00:43:24.926 --> 00:43:27.126 A:middle
I'm going to just do directions
in response to user input

1006
00:43:27.126 --> 00:43:28.696 A:middle
and you know you can
do a few of those

1007
00:43:28.696 --> 00:43:30.086 A:middle
because we showed
them that example.

1008
00:43:30.086 --> 00:43:32.086 A:middle
Like we did two directions
request in response

1009
00:43:32.086 --> 00:43:33.096 A:middle
to one user input, that's fine.

1010
00:43:33.556 --> 00:43:37.696 A:middle
But, you know if you're doing
10,000 every time the user taps

1011
00:43:37.696 --> 00:43:39.286 A:middle
on the screen, then you're
going to get throttled.

1012
00:43:39.286 --> 00:43:41.156 A:middle
But, just keep it
reasonable and you'll be fine.

1013
00:43:42.256 --> 00:43:43.076 A:middle
So, that's everything.

1014
00:43:43.296 --> 00:43:44.476 A:middle
Let's go into our conclusion.

1015
00:43:45.156 --> 00:43:46.566 A:middle
So, what did we learn?

1016
00:43:46.836 --> 00:43:47.966 A:middle
There's many new features.

1017
00:43:47.966 --> 00:43:49.456 A:middle
In fact, we couldn't even
have covered them all

1018
00:43:49.456 --> 00:43:49.926 A:middle
in this session.

1019
00:43:49.926 --> 00:43:51.006 A:middle
We have a session coming up.

1020
00:43:51.606 --> 00:43:53.446 A:middle
The first of which
was Map Kit OS X,

1021
00:43:53.886 --> 00:43:55.486 A:middle
which is I think my
favorite feature.

1022
00:43:55.756 --> 00:43:59.156 A:middle
I'm really excited to see what
you guys come up with on OS X.

1023
00:43:59.836 --> 00:44:02.256 A:middle
There's the updates to iOS 7 UI.

1024
00:44:02.486 --> 00:44:04.046 A:middle
So, there's a new UI in iOS 7

1025
00:44:04.046 --> 00:44:06.216 A:middle
and that changes a few
things in MKMapView.

1026
00:44:07.496 --> 00:44:09.876 A:middle
We've got 3D maps and
spanning the 180th meridian.

1027
00:44:10.956 --> 00:44:12.676 A:middle
We've got new Overlays
Functionality

1028
00:44:12.676 --> 00:44:15.196 A:middle
so we've got polylines,
polygons,

1029
00:44:15.196 --> 00:44:17.016 A:middle
other overlays underneath
your labels.

1030
00:44:17.016 --> 00:44:18.386 A:middle
We've got the geodesic
polylines.

1031
00:44:18.386 --> 00:44:19.696 A:middle
We've got MKTileOverlay.

1032
00:44:20.186 --> 00:44:23.056 A:middle
We've got the ability to replace
Apple's Map Data with your own

1033
00:44:23.056 --> 00:44:25.046 A:middle
and we've got Performance
Improvement for Overlays.

1034
00:44:26.266 --> 00:44:28.846 A:middle
We've got the Search API
and the Directions API.

1035
00:44:30.026 --> 00:44:33.216 A:middle
So, what I'd like to ask you
to do is try these things out.

1036
00:44:33.376 --> 00:44:33.976 A:middle
Try them soon.

1037
00:44:33.976 --> 00:44:34.596 A:middle
Like try them this week.

1038
00:44:34.756 --> 00:44:35.456 A:middle
Try them next week.

1039
00:44:35.766 --> 00:44:39.916 A:middle
I want it to work for you,
but if it doesn't please go

1040
00:44:39.916 --> 00:44:42.426 A:middle
to bugreport.apple.com and file
a bug so that we can fix it.

1041
00:44:43.736 --> 00:44:46.016 A:middle
For more information you can
email our Evangelist who's

1042
00:44:46.016 --> 00:44:46.826 A:middle
Paul Marcos.

1043
00:44:46.826 --> 00:44:47.806 A:middle
That's his email up there.

1044
00:44:48.216 --> 00:44:49.616 A:middle
We've got some Documentation.

1045
00:44:49.796 --> 00:44:51.866 A:middle
I know that's a long URL but if
you on our website and search

1046
00:44:51.866 --> 00:44:54.166 A:middle
for MKMapUIDeveloper.apple.com
you'll find it.

1047
00:44:54.506 --> 00:44:56.356 A:middle
There's also the Location
Awareness Programming Guide,

1048
00:44:56.356 --> 00:44:57.936 A:middle
which has info on
both Core Location

1049
00:44:57.976 --> 00:44:59.546 A:middle
and Map Kit, which is good.

1050
00:44:59.866 --> 00:45:03.116 A:middle
And there's the Developer Forum
which I try to read occasionally

1051
00:45:03.186 --> 00:45:04.596 A:middle
and so I may see you in there.

1052
00:45:05.946 --> 00:45:08.046 A:middle
And the next thing to say is
we've got a session at 2:00.

1053
00:45:08.456 --> 00:45:09.496 A:middle
You should go to the session.

1054
00:45:09.576 --> 00:45:11.226 A:middle
It's the second half of this.

1055
00:45:11.296 --> 00:45:14.176 A:middle
There's a whole bunch
more content on 3D Maps.

1056
00:45:14.626 --> 00:45:16.556 A:middle
We also got Static Map
Snapshots, which we're going

1057
00:45:16.556 --> 00:45:18.346 A:middle
to cover in there
and you should attend

1058
00:45:18.346 --> 00:45:19.306 A:middle
that session this afternoon.

1059
00:45:19.746 --> 00:45:20.486 A:middle
So, that's everything.

1060
00:45:20.846 --> 00:45:21.616 A:middle
Thank you all very much.

1061
00:45:22.116 --> 00:45:28.980 A:middle
[ Applause ]

