

1
00:00:00.506 --> 00:00:11.026 A:middle
[ Silence ]

2
00:00:11.526 --> 00:00:15.686 A:middle
&gt;&gt; Hi and welcome to Integrating
Passbook into your Ecosystem.

3
00:00:16.056 --> 00:00:18.676 A:middle
My name is Joelle Lam,
an Engineering Manager

4
00:00:18.676 --> 00:00:22.736 A:middle
at the Apple Store App Team,
also the Engineering Lead

5
00:00:22.736 --> 00:00:26.436 A:middle
of Apple Store Gift Card
in Passbook from WWDC

6
00:00:26.436 --> 00:00:28.696 A:middle
to its launch in October.

7
00:00:29.296 --> 00:00:33.746 A:middle
Last year iOS 6 announced
Passbook.

8
00:00:34.616 --> 00:00:37.756 A:middle
Passbook was this way you can
include your boarding passes,

9
00:00:38.086 --> 00:00:42.566 A:middle
your movie tickets and more on
your iPhone or your iPod Touch.

10
00:00:44.056 --> 00:00:48.086 A:middle
Now, us being the Apple
Store Engineering Team,

11
00:00:48.656 --> 00:00:52.616 A:middle
we knew we wanted to be part of
this, we knew we were missing

12
00:00:52.616 --> 00:00:56.196 A:middle
out if we didn't get involved
in the Passbook Ecosystem.

13
00:00:57.216 --> 00:01:03.006 A:middle
So, very quickly came Apple
Store Gift Card in Passbook.

14
00:01:04.396 --> 00:01:07.496 A:middle
Now, I'm not from
the Passbook Team.

15
00:01:07.706 --> 00:01:10.776 A:middle
If anything I'm more
like you, I sat there

16
00:01:10.896 --> 00:01:12.506 A:middle
and watched the WWDC sessions,

17
00:01:12.596 --> 00:01:15.816 A:middle
I'm like an external
developer looking

18
00:01:15.816 --> 00:01:18.986 A:middle
onto iOS technologies asking,

19
00:01:19.776 --> 00:01:22.296 A:middle
"How do I enrich
the user experience?

20
00:01:22.796 --> 00:01:26.436 A:middle
How do I bring to life
some everyday things,

21
00:01:26.486 --> 00:01:29.596 A:middle
these everyday things that
used to exist in our pockets?"

22
00:01:30.076 --> 00:01:33.986 A:middle
OK. So, let's do
a quick overview.

23
00:01:33.986 --> 00:01:37.936 A:middle
We're first going to talk
about Apple Store Gift Card,

24
00:01:38.236 --> 00:01:40.576 A:middle
this is all about
pulling back that curtain

25
00:01:41.076 --> 00:01:42.106 A:middle
and showing you a little bit

26
00:01:42.106 --> 00:01:44.446 A:middle
about what we did
and why we did it.

27
00:01:45.736 --> 00:01:48.316 A:middle
Then we'll go into
leveraging existing systems.

28
00:01:48.516 --> 00:01:53.376 A:middle
I thought this was so important
because some of you guys are

29
00:01:53.376 --> 00:01:57.766 A:middle
out there, you have these huge
systems and you're wondering,

30
00:01:58.146 --> 00:02:00.546 A:middle
"Can I bring Passbook
to my Ecosystem?"

31
00:02:01.226 --> 00:02:05.936 A:middle
You have ASP downstream, how
many weeks do I have to prepare

32
00:02:05.936 --> 00:02:07.596 A:middle
for it, to talk to a DVA just

33
00:02:07.596 --> 00:02:10.126 A:middle
to get a database
let alone 3, right?

34
00:02:11.466 --> 00:02:15.576 A:middle
And then I have to do security
review just to get the ACLs

35
00:02:15.576 --> 00:02:19.206 A:middle
to talk to my security
systems or talk to my services.

36
00:02:19.236 --> 00:02:24.406 A:middle
So, leveraging existing systems
is all about bringing Passbook

37
00:02:24.406 --> 00:02:28.426 A:middle
to your Ecosystem no
matter how complex it is.

38
00:02:30.436 --> 00:02:32.666 A:middle
Then we'll talk about
determining complexity.

39
00:02:33.676 --> 00:02:38.186 A:middle
This is kind of an experience of
wisdom of what we think it talks

40
00:02:38.186 --> 00:02:41.336 A:middle
to determine the level of
effort to build your pass.

41
00:02:42.546 --> 00:02:46.136 A:middle
And finally, we'll do some
web services tips and tricks.

42
00:02:46.136 --> 00:02:49.456 A:middle
These tips and tricks are kind
of separated by complexity level

43
00:02:49.456 --> 00:02:52.006 A:middle
so they'll be something
there a lot of good meat

44
00:02:52.006 --> 00:02:53.976 A:middle
but something there for
every single one of you guys.

45
00:02:55.136 --> 00:02:59.026 A:middle
So, let's get started.

46
00:02:59.076 --> 00:03:03.156 A:middle
Apple Store Gift Card is all
about giving the people you care

47
00:03:03.156 --> 00:03:05.246 A:middle
about the products
you love, right?

48
00:03:06.066 --> 00:03:09.466 A:middle
If you look at this life cycle

49
00:03:09.466 --> 00:03:13.466 A:middle
of our gift card somebody
will go into the app

50
00:03:13.736 --> 00:03:16.426 A:middle
or on the website and
they'll purchase a gift card

51
00:03:17.266 --> 00:03:21.996 A:middle
and this gift card will then
get emailed to the giftee.

52
00:03:23.206 --> 00:03:24.806 A:middle
So, when we're delivering
that card,

53
00:03:24.806 --> 00:03:27.706 A:middle
we're actually delivering
an email with a link in it

54
00:03:28.386 --> 00:03:31.676 A:middle
which allows that person, the
giftee, to receive that card.

55
00:03:32.866 --> 00:03:34.826 A:middle
Finally, that card is
open to the Passbook

56
00:03:34.826 --> 00:03:37.336 A:middle
and the user can
look at the pass.

57
00:03:38.586 --> 00:03:42.156 A:middle
From there the Passbook can--
the gift card can be brought

58
00:03:42.156 --> 00:03:45.536 A:middle
into a store used
online and redeemed.

59
00:03:46.406 --> 00:03:47.916 A:middle
You can use it to
purchase something.

60
00:03:48.516 --> 00:03:51.076 A:middle
And if immediately when
that purchase occurs,

61
00:03:52.246 --> 00:03:55.496 A:middle
we send an update and the update
will actually update the path

62
00:03:55.496 --> 00:03:59.056 A:middle
and the giftee can now see
their new value in the pass.

63
00:03:59.946 --> 00:04:01.636 A:middle
Of course if they
have a value left,

64
00:04:01.926 --> 00:04:03.796 A:middle
they can continue
that cycle again.

65
00:04:04.356 --> 00:04:12.006 A:middle
OK. So, delivering the pass.

66
00:04:12.156 --> 00:04:15.256 A:middle
Apple Store Gift Card
is kind of a different--

67
00:04:15.566 --> 00:04:17.796 A:middle
a little bit of an advance pass.

68
00:04:18.305 --> 00:04:22.426 A:middle
You'll see that its flow and
giving a user pass is different

69
00:04:22.426 --> 00:04:23.496 A:middle
than what you would expect.

70
00:04:23.756 --> 00:04:28.396 A:middle
It doesn't actually
use a Companion App,

71
00:04:28.396 --> 00:04:30.076 A:middle
we use quite a few things.

72
00:04:30.416 --> 00:04:33.986 A:middle
So, if you get overwhelmed as
you're looking at our lifecycle

73
00:04:33.986 --> 00:04:36.916 A:middle
or as you're looking at
our flows, don't worry,

74
00:04:36.916 --> 00:04:39.856 A:middle
when we get to kind of
determining your complexity,

75
00:04:39.856 --> 00:04:43.316 A:middle
you will realize that you don't
need to do everything we did

76
00:04:43.316 --> 00:04:45.676 A:middle
but there'll be a lot of good
things you can carry away

77
00:04:45.676 --> 00:04:49.216 A:middle
from this, OK?

78
00:04:49.416 --> 00:04:51.486 A:middle
So, how many guys have the App?

79
00:04:51.486 --> 00:04:51.926 A:middle
Apple Store App?

80
00:04:52.206 --> 00:04:54.156 A:middle
You guys have it?

81
00:04:54.156 --> 00:04:57.486 A:middle
Good. Good, that's like
60, 70 percent, I like it.

82
00:04:57.836 --> 00:05:00.476 A:middle
How many of you don't?

83
00:05:00.476 --> 00:05:02.816 A:middle
You guys, OK.

84
00:05:03.146 --> 00:05:06.576 A:middle
[laughs] I'm impressed
though, that's honest.

85
00:05:06.576 --> 00:05:10.816 A:middle
OK? So, step one,
download the App.

86
00:05:10.816 --> 00:05:14.926 A:middle
Step one, open the App and
you get to look at the passes.

87
00:05:14.926 --> 00:05:19.846 A:middle
For me, I'm going to purchase a
pass for-- one of my coworkers,

88
00:05:19.906 --> 00:05:24.196 A:middle
Sonal, she's been working really
hard and she's kind of new

89
00:05:24.196 --> 00:05:26.546 A:middle
to Apple, she doesn't
have all the technologies,

90
00:05:26.546 --> 00:05:27.306 A:middle
all the products yet.

91
00:05:27.306 --> 00:05:28.876 A:middle
So, I'm going to
buy her an Apple TV,

92
00:05:28.876 --> 00:05:30.826 A:middle
I've picked out a
nice pass here.

93
00:05:30.826 --> 00:05:33.606 A:middle
110 dollars, you buy
her an Apple TV, right?

94
00:05:33.606 --> 00:05:38.026 A:middle
Then I'll put a nice little
message in there, say,

95
00:05:38.026 --> 00:05:40.366 A:middle
it's to Sona and from me.

96
00:05:41.566 --> 00:05:43.366 A:middle
And I'm telling her
to enjoy her Apple TV.

97
00:05:43.366 --> 00:05:44.166 A:middle
She's worked really hard.

98
00:05:44.716 --> 00:05:50.626 A:middle
OK, then once the order is
submitted, gift process,

99
00:05:50.746 --> 00:05:52.116 A:middle
an email gets sent out.

100
00:05:52.526 --> 00:05:55.406 A:middle
Just like every single Gift Card
email that we previously had.

101
00:05:56.536 --> 00:05:58.446 A:middle
Sonal will read this
and go, "Cool,

102
00:05:58.446 --> 00:06:00.386 A:middle
I got an apple TV,
this is so great."

103
00:06:00.386 --> 00:06:01.326 A:middle
She's going to open it up.

104
00:06:01.886 --> 00:06:04.286 A:middle
So, notice the add
to Passbook link.

105
00:06:05.146 --> 00:06:08.286 A:middle
So, click on it and be
brought to mobile Safari.

106
00:06:08.966 --> 00:06:14.676 A:middle
Now, this is our opportunity
to basically tag this pass

107
00:06:15.086 --> 00:06:17.086 A:middle
with the ten years Apple Stores.

108
00:06:18.036 --> 00:06:21.486 A:middle
You can use iBeacons now
if you prefer to do that,

109
00:06:22.186 --> 00:06:23.486 A:middle
but or you could use both.

110
00:06:23.486 --> 00:06:26.376 A:middle
So, that if she ever
forgets that she has this

111
00:06:26.376 --> 00:06:28.786 A:middle
and she walks near one of
our stores, she'll remember.

112
00:06:29.876 --> 00:06:32.666 A:middle
Then she clicks to
create the pass and be--

113
00:06:32.666 --> 00:06:38.446 A:middle
there it is, her Apple TV
ready for her to pick up.

114
00:06:38.646 --> 00:06:42.616 A:middle
OK. So, what were some
of the Apple Stores goals

115
00:06:42.616 --> 00:06:44.846 A:middle
in building this pass?

116
00:06:46.276 --> 00:06:49.226 A:middle
Passbook was an additional
avenue

117
00:06:50.286 --> 00:06:51.726 A:middle
to get in Gift Cards users.

118
00:06:52.796 --> 00:06:56.496 A:middle
It's not like I was able to
reimagine my backend systems,

119
00:06:56.496 --> 00:06:59.926 A:middle
I wasn't able to reimagine
the paper gift card, I mean,

120
00:06:59.926 --> 00:07:01.446 A:middle
if I had a choice,
I would do way

121
00:07:01.446 --> 00:07:03.096 A:middle
with the paper gift
card entirely.

122
00:07:03.476 --> 00:07:04.456 A:middle
But I didn't have a choice.

123
00:07:05.446 --> 00:07:08.466 A:middle
Those avenues had to
continue to coexist

124
00:07:08.956 --> 00:07:11.806 A:middle
with the Passbook avenue.

125
00:07:11.906 --> 00:07:15.676 A:middle
So, really, Passbook is
complimenting the entire system.

126
00:07:16.426 --> 00:07:19.316 A:middle
Existing avenues
shouldn't get harder, right?

127
00:07:19.316 --> 00:07:24.866 A:middle
And then a great fine that I
think that we stumbled upon.

128
00:07:25.716 --> 00:07:30.146 A:middle
Last year, when we were watching
the Passbook presentations,

129
00:07:30.676 --> 00:07:32.386 A:middle
we thought, "oh, oK, so we have

130
00:07:32.426 --> 00:07:35.776 A:middle
to make sure we have a Companion
App and somehow this has to work

131
00:07:35.986 --> 00:07:39.366 A:middle
with Apple Store App even though
the gifter is not the giftee"

132
00:07:40.076 --> 00:07:45.486 A:middle
and it occurred to me that
our Companion App is not

133
00:07:45.486 --> 00:07:46.166 A:middle
really acquired.

134
00:07:47.336 --> 00:07:51.406 A:middle
In fact, there's a
larger base of users

135
00:07:52.176 --> 00:07:53.416 A:middle
that have access to mail.

136
00:07:54.426 --> 00:07:57.156 A:middle
So, if you can detach
yourself from the requirement

137
00:07:57.156 --> 00:08:00.456 A:middle
of a companion app, you
actually have access

138
00:08:01.026 --> 00:08:03.356 A:middle
to much larger user base, right?

139
00:08:03.356 --> 00:08:05.736 A:middle
There's more of a chance
that they will see,

140
00:08:06.476 --> 00:08:11.616 A:middle
they'll see my Gift
Card then if it goes

141
00:08:11.616 --> 00:08:13.616 A:middle
to your mail then they have
download my pass because--

142
00:08:13.716 --> 00:08:14.596 A:middle
or downloaded my app,

143
00:08:14.596 --> 00:08:16.056 A:middle
not everyone has
downloaded their app,

144
00:08:16.056 --> 00:08:17.006 A:middle
right, as we saw here.

145
00:08:17.246 --> 00:08:20.286 A:middle
But everyone in here
has access to mail, OK?

146
00:08:20.286 --> 00:08:24.796 A:middle
So, no companion app
required, and then lastly,

147
00:08:24.906 --> 00:08:26.496 A:middle
integrating with
existing systems.

148
00:08:28.056 --> 00:08:31.026 A:middle
I couldn't touch or change many

149
00:08:31.026 --> 00:08:32.775 A:middle
of the systems that
I have below me.

150
00:08:32.836 --> 00:08:35.566 A:middle
So, we have to make sure
that we minimize our changes

151
00:08:36.166 --> 00:08:39.996 A:middle
and we'll talk about that
one little later, OK?

152
00:08:41.145 --> 00:08:43.926 A:middle
So, Sonal, she works
really hard, she doesn't go

153
00:08:43.926 --> 00:08:45.796 A:middle
to the mall a lot, but
now she's in the mall

154
00:08:45.796 --> 00:08:48.656 A:middle
and she's walking along and she
walks across the Apple Store.

155
00:08:49.216 --> 00:08:52.096 A:middle
And boom, her pass lights up
and says, "Hey, don't forget"

156
00:08:52.306 --> 00:08:55.176 A:middle
or sorry, she gets a lock screen
notice that says, "Don't forget

157
00:08:55.176 --> 00:08:56.756 A:middle
to use your-- go
get your Apple TV."

158
00:08:57.376 --> 00:09:00.946 A:middle
So, she goes in, she picks
up her Apple TV or her--

159
00:09:00.946 --> 00:09:03.396 A:middle
she picks up her Apple TV and
picks up her pass and says,

160
00:09:03.656 --> 00:09:04.546 A:middle
"Yes, I want to purchase.

161
00:09:04.636 --> 00:09:07.996 A:middle
And so you just can see
we use the QR code there.

162
00:09:07.996 --> 00:09:11.556 A:middle
Lucky for us, our point of
cell devices are iPhones.

163
00:09:11.946 --> 00:09:13.416 A:middle
So, we simply have to enable

164
00:09:13.416 --> 00:09:16.146 A:middle
that camera and scan
the QR code.

165
00:09:16.846 --> 00:09:20.456 A:middle
And lucky for you, AV Foundation
is going to do all that work

166
00:09:20.516 --> 00:09:22.766 A:middle
for you, you guys don't have
to think about shake factor

167
00:09:23.076 --> 00:09:25.146 A:middle
and a lot of things that we
have to be concerned about.

168
00:09:25.416 --> 00:09:26.866 A:middle
So, definitely take
advantage of that.

169
00:09:27.816 --> 00:09:29.886 A:middle
But let's say she
never gets to the mall.

170
00:09:30.466 --> 00:09:35.466 A:middle
Let's say she still wants
to get her Apple TV.

171
00:09:36.426 --> 00:09:38.936 A:middle
She still has to be able to
purchase on the web, right?

172
00:09:38.936 --> 00:09:42.856 A:middle
She has to be able to turn that
pass over reading clear text

173
00:09:42.856 --> 00:09:45.796 A:middle
to gift card and a pin
number and make the purchase.

174
00:09:46.296 --> 00:09:49.436 A:middle
So, we actually have to provide
the data both in the QR code

175
00:09:49.746 --> 00:09:52.906 A:middle
and on the back of the pass
in clear text, make sense?

176
00:09:53.076 --> 00:09:55.946 A:middle
Good, I see some of you nodding.

177
00:09:55.946 --> 00:10:00.366 A:middle
OK. So, using the pass,
you'll see this kind of theme

178
00:10:00.366 --> 00:10:03.336 A:middle
or reusing and leveraging
existing systems,

179
00:10:03.696 --> 00:10:06.006 A:middle
we reused the point of sale
devices, we didn't have

180
00:10:06.006 --> 00:10:07.526 A:middle
to replace them if you need to,

181
00:10:07.856 --> 00:10:10.176 A:middle
write an app Leverage
AV Foundation

182
00:10:10.696 --> 00:10:12.136 A:middle
to use optical scanners.

183
00:10:14.296 --> 00:10:16.066 A:middle
And then we have the
support, the web.

184
00:10:16.246 --> 00:10:17.926 A:middle
We even have to support
the phone.

185
00:10:17.926 --> 00:10:19.256 A:middle
Yes, people still use a phone.

186
00:10:20.066 --> 00:10:23.826 A:middle
But something that
surprised us, little it was,

187
00:10:24.336 --> 00:10:26.406 A:middle
it was a little bit--
at least the surprise

188
00:10:26.406 --> 00:10:28.596 A:middle
for me was the human factor.

189
00:10:29.556 --> 00:10:32.566 A:middle
Apple have some of the
greatest retail employees.

190
00:10:33.746 --> 00:10:35.646 A:middle
But as you know,
retail employees ebb

191
00:10:35.646 --> 00:10:37.366 A:middle
and flow based on the seasons.

192
00:10:38.256 --> 00:10:41.966 A:middle
So, when we first decided
to launch the Passbook,

193
00:10:41.966 --> 00:10:43.206 A:middle
we've trained a bunch of people.

194
00:10:43.616 --> 00:10:46.356 A:middle
But there was no guarantee
just a few months later

195
00:10:46.356 --> 00:10:48.546 A:middle
that the people that
we trained we're going

196
00:10:48.546 --> 00:10:51.206 A:middle
to be the people we would
go live with or launch with.

197
00:10:51.726 --> 00:10:55.706 A:middle
What I've learned from
this is how important it is

198
00:10:56.076 --> 00:10:59.756 A:middle
that we design and develop
even our point of sale devices

199
00:10:59.756 --> 00:11:02.516 A:middle
that only our sales
agents use to make sure

200
00:11:02.516 --> 00:11:05.906 A:middle
that it's almost impossible
for them to make a mistake.

201
00:11:06.766 --> 00:11:08.996 A:middle
So, what kind of mistakes
could they have possibly made,

202
00:11:08.996 --> 00:11:10.476 A:middle
it's just an optical
scanner, right?

203
00:11:11.526 --> 00:11:14.926 A:middle
Well, actually one of the
Apple employees they walked

204
00:11:14.926 --> 00:11:17.436 A:middle
into the Apple store
with their Passbook

205
00:11:17.436 --> 00:11:22.526 A:middle
and the sales agent was trying
to laser scan this QR code

206
00:11:22.526 --> 00:11:24.006 A:middle
and he's like, "Why
isn't this working?"

207
00:11:24.006 --> 00:11:26.056 A:middle
You just sitting there looking,
"Should I say something?"

208
00:11:26.816 --> 00:11:28.656 A:middle
Well, they are looking
at, you know,

209
00:11:28.656 --> 00:11:30.656 A:middle
they usually see this one
dimensional bar codes,

210
00:11:30.856 --> 00:11:32.726 A:middle
a two dimensional bar code

211
00:11:32.726 --> 00:11:34.916 A:middle
to a retail employee may
not be that different.

212
00:11:36.226 --> 00:11:41.136 A:middle
So, bottom line is target
user experience consistency.

213
00:11:42.016 --> 00:11:45.916 A:middle
If you're trying to be very
consistent for every user,

214
00:11:45.916 --> 00:11:48.896 A:middle
you'll realize you cannot
train every sales agent.

215
00:11:49.156 --> 00:11:49.636 A:middle
You just can't.

216
00:11:50.556 --> 00:11:53.636 A:middle
So, build into your
point of sale device.

217
00:11:54.906 --> 00:11:57.126 A:middle
The obvious thing
that the user should--

218
00:11:57.126 --> 00:12:00.666 A:middle
that the sales agent should
do out of a button there

219
00:12:00.666 --> 00:12:03.586 A:middle
that says check out with
Passbook, make it very clear

220
00:12:03.586 --> 00:12:06.906 A:middle
so nobody [inaudible] both the
sales agent and the customers.

221
00:12:07.536 --> 00:12:11.376 A:middle
OK, updating the pass.

222
00:12:13.116 --> 00:12:15.126 A:middle
This is the web services
portions, right?

223
00:12:15.126 --> 00:12:20.466 A:middle
This is the feedback loop
bringing to life your pass.

224
00:12:20.656 --> 00:12:25.086 A:middle
Once a redemption occurs,
if you can tell the user

225
00:12:25.086 --> 00:12:28.546 A:middle
that something has happened
it's so much more rewarding.

226
00:12:28.716 --> 00:12:31.616 A:middle
And I do it every time I go
in and if I have a gift card

227
00:12:31.616 --> 00:12:33.286 A:middle
and the sales agent
makes the purchase

228
00:12:33.716 --> 00:12:36.986 A:middle
and almost seconds later you
guys should try almost seconds

229
00:12:36.986 --> 00:12:40.136 A:middle
later the value updates
and you're like, "Oh OK,

230
00:12:40.136 --> 00:12:42.166 A:middle
what I just did actually
happened."

231
00:12:42.556 --> 00:12:45.836 A:middle
There's kind of event in a--
a satisfaction that occurs.

232
00:12:46.396 --> 00:12:49.866 A:middle
So, update your passes, use
Apple Push Notification service.

233
00:12:49.956 --> 00:12:54.336 A:middle
Super easy to do and bring
that feedback look all the way

234
00:12:54.336 --> 00:12:58.526 A:middle
around feedback to the user,
feedback to your sales agent.

235
00:13:00.306 --> 00:13:04.556 A:middle
Apple Store Gift Card.

236
00:13:04.746 --> 00:13:05.926 A:middle
OK, let's move on.

237
00:13:07.516 --> 00:13:11.046 A:middle
[ Pause ]

238
00:13:11.546 --> 00:13:13.696 A:middle
Leveraging your existing
systems.

239
00:13:14.486 --> 00:13:18.166 A:middle
If you come from a
larger organization

240
00:13:18.166 --> 00:13:20.996 A:middle
or an organization even that's
been around for a while,

241
00:13:21.476 --> 00:13:23.976 A:middle
your systems architecture
diagram might look something

242
00:13:23.976 --> 00:13:24.526 A:middle
like this.

243
00:13:26.076 --> 00:13:28.636 A:middle
You start with an App
and this is the App

244
00:13:28.696 --> 00:13:30.246 A:middle
that we purchase with, right?

245
00:13:30.616 --> 00:13:32.916 A:middle
And it talks to our
applications and services layer.

246
00:13:32.916 --> 00:13:38.576 A:middle
And then it talks to our
order processor and then it--

247
00:13:38.576 --> 00:13:40.016 A:middle
the order is inducted by ASP,

248
00:13:40.016 --> 00:13:42.016 A:middle
it's probably written
to a database.

249
00:13:43.036 --> 00:13:45.536 A:middle
We notify our physical
gift card services.

250
00:13:45.726 --> 00:13:47.866 A:middle
Hey, we have a gift card
that we need you to generate.

251
00:13:48.506 --> 00:13:50.986 A:middle
And when that card gets
generated it probably writes

252
00:13:51.026 --> 00:13:55.186 A:middle
to a data base and then e-mail
gets sent out and on and on

253
00:13:55.186 --> 00:13:57.626 A:middle
and on and there's a lot
of boxes there, right?

254
00:13:57.796 --> 00:13:59.576 A:middle
That's really all you're
thinking about right now

255
00:13:59.576 --> 00:14:01.416 A:middle
and I would agree with you,
there are a lot of boxes there.

256
00:14:02.576 --> 00:14:08.006 A:middle
So, the goal is to identify all
those boxes that do not matter.

257
00:14:09.296 --> 00:14:11.836 A:middle
Maintain only the
relevant boxes.

258
00:14:12.316 --> 00:14:14.206 A:middle
Maintain only the ones
you need to change.

259
00:14:14.456 --> 00:14:18.906 A:middle
So, then you're pushing into
this black box all the things

260
00:14:18.906 --> 00:14:22.746 A:middle
that are no longer relevant, and
you can push and push and push

261
00:14:22.746 --> 00:14:24.746 A:middle
and identify those things
you don't need to touch

262
00:14:24.746 --> 00:14:26.026 A:middle
until you end up
looking like this.

263
00:14:27.546 --> 00:14:31.386 A:middle
There are four interfaces
no matter how complex your

264
00:14:31.466 --> 00:14:35.476 A:middle
Ecosystem is, there are four
interfaces you must work with.

265
00:14:37.216 --> 00:14:41.556 A:middle
Number one, creating the pass.

266
00:14:41.766 --> 00:14:43.326 A:middle
This was-- we used
e-mail, right?

267
00:14:43.326 --> 00:14:44.586 A:middle
There is a link in the e-mail.

268
00:14:44.836 --> 00:14:48.676 A:middle
What is the interface in which
you generate or create and get

269
00:14:48.676 --> 00:14:49.636 A:middle
that pass to that user.

270
00:14:51.186 --> 00:14:53.866 A:middle
Number two, source of truth.

271
00:14:55.066 --> 00:14:58.946 A:middle
This is the system that knows
the ultimate value of your pass.

272
00:14:59.736 --> 00:15:02.646 A:middle
It's what your pass
primarily represents.

273
00:15:04.236 --> 00:15:07.626 A:middle
Number three, redeeming
your pass.

274
00:15:07.746 --> 00:15:12.956 A:middle
The interface for redeeming your
pass, how do you use that pass?

275
00:15:13.326 --> 00:15:16.936 A:middle
And number four, this is the
call back for the update.

276
00:15:17.326 --> 00:15:20.096 A:middle
Once the pass has been
redeemed, how do you know

277
00:15:20.096 --> 00:15:23.056 A:middle
that there has been a change or
once the pass has been changed

278
00:15:23.056 --> 00:15:26.166 A:middle
in any way, how do you know
the pass has been changed?

279
00:15:27.046 --> 00:15:28.276 A:middle
So, four interfaces, right?

280
00:15:31.766 --> 00:15:36.256 A:middle
Then, you need to
identify the common factor

281
00:15:36.256 --> 00:15:37.466 A:middle
between all four of those.

282
00:15:38.116 --> 00:15:41.886 A:middle
The common currency,
for us I used GCN here

283
00:15:41.886 --> 00:15:42.956 A:middle
but it's a Gift Card Number.

284
00:15:43.436 --> 00:15:45.796 A:middle
All of these systems
that I must interface

285
00:15:45.896 --> 00:15:48.296 A:middle
with know what a
gift card number is.

286
00:15:48.536 --> 00:15:50.746 A:middle
So, if you have these
four interfaces,

287
00:15:51.076 --> 00:15:53.086 A:middle
you have the common currency.

288
00:15:53.756 --> 00:15:58.476 A:middle
You'll be able to bring Passbook
guaranteed to your Ecosystem.

289
00:15:59.356 --> 00:16:01.436 A:middle
OK, what are some common
currencies for you guys?

290
00:16:02.916 --> 00:16:04.196 A:middle
So, we use gift card number.

291
00:16:04.806 --> 00:16:09.776 A:middle
They might be club card number,
an Event ID, and Event ID

292
00:16:09.776 --> 00:16:11.796 A:middle
with the customer
ID and order number.

293
00:16:12.236 --> 00:16:15.256 A:middle
There are a lot of things but
just identify that shared piece

294
00:16:15.256 --> 00:16:17.516 A:middle
of information is probably
a primary key somewhere

295
00:16:17.516 --> 00:16:21.496 A:middle
in one of your data bases.

296
00:16:22.976 --> 00:16:24.896 A:middle
OK, so then six months later

297
00:16:25.336 --> 00:16:27.156 A:middle
when your boss is
giving a presentation

298
00:16:27.156 --> 00:16:29.936 A:middle
about how awesome your team
is because we integrated

299
00:16:29.936 --> 00:16:32.396 A:middle
with all these systems,
you can say, "Yeah,

300
00:16:33.126 --> 00:16:35.436 A:middle
but this is really what
I did, four interfaces.

301
00:16:35.996 --> 00:16:40.296 A:middle
OK, determining complexity.

302
00:16:41.006 --> 00:16:45.496 A:middle
Now, stepping back from
everything that we needed to do

303
00:16:45.496 --> 00:16:49.216 A:middle
to bring Passbook, to
bring this pass to Apple,

304
00:16:49.216 --> 00:16:53.596 A:middle
I think we can kind of impart
an experience or wisdom

305
00:16:53.906 --> 00:16:58.326 A:middle
of what it takes to determine
the level of effort required

306
00:16:58.726 --> 00:17:01.076 A:middle
to bringing a pass
to your system.

307
00:17:01.616 --> 00:17:08.006 A:middle
I've identified five facets that
I think are really significant.

308
00:17:09.195 --> 00:17:15.036 A:middle
First one is value, uniqueness,
static versus dynamic,

309
00:17:15.906 --> 00:17:18.846 A:middle
scale and systems integration.

310
00:17:20.116 --> 00:17:23.496 A:middle
And on each of these facets
is kind of a sub scale

311
00:17:23.496 --> 00:17:24.826 A:middle
or scale within itself.

312
00:17:27.175 --> 00:17:29.066 A:middle
I'm using mountains
of science here.

313
00:17:29.066 --> 00:17:30.986 A:middle
I don't know, do you
guys snowboarder or ski?

314
00:17:30.986 --> 00:17:32.506 A:middle
Thought something you
guys do around here, no?

315
00:17:32.966 --> 00:17:35.266 A:middle
No? a little bit of
clapping out there.

316
00:17:35.496 --> 00:17:38.096 A:middle
OK so, the greens, you
guys know what those are?

317
00:17:38.566 --> 00:17:40.496 A:middle
The greens are for
people who kind

318
00:17:40.496 --> 00:17:42.816 A:middle
of don't know what they're
doing but still are courageous

319
00:17:42.816 --> 00:17:43.636 A:middle
and want to be out there.

320
00:17:43.636 --> 00:17:47.446 A:middle
And then hopefully at some point
they transition to intermediate

321
00:17:48.326 --> 00:17:51.056 A:middle
and intermediate is a little
bit harder, you need some skill,

322
00:17:51.056 --> 00:17:54.636 A:middle
you maybe took some classes and
then you move to the blacks,

323
00:17:54.636 --> 00:17:56.006 A:middle
the advanced category.

324
00:17:56.336 --> 00:17:57.676 A:middle
And the advanced is where you--

325
00:17:57.676 --> 00:18:00.186 A:middle
you're kind of parsing
through the snow

326
00:18:00.186 --> 00:18:01.986 A:middle
and you know exactly
what's going on.

327
00:18:01.986 --> 00:18:02.886 A:middle
I see some nodding.

328
00:18:04.496 --> 00:18:06.056 A:middle
So, there's a small scale.

329
00:18:06.096 --> 00:18:08.206 A:middle
There's a scale within
each one of these facets

330
00:18:08.206 --> 00:18:09.386 A:middle
and we're going to review them.

331
00:18:09.766 --> 00:18:19.016 A:middle
Value, value as a value
of your pass increases,

332
00:18:19.546 --> 00:18:21.366 A:middle
the complexity is
going to increase.

333
00:18:22.316 --> 00:18:25.566 A:middle
So, when you start with a
newspaper ad for instance,

334
00:18:26.326 --> 00:18:30.516 A:middle
a newspaper coupon might be free
because anybody can get to it.

335
00:18:30.516 --> 00:18:32.986 A:middle
And I know it might
have some value

336
00:18:32.986 --> 00:18:36.326 A:middle
because with redemption it
ends up adding value to you

337
00:18:36.326 --> 00:18:39.816 A:middle
but we really don't care
who's stealing that coupon.

338
00:18:41.256 --> 00:18:45.136 A:middle
Then a movie ticket, we
move up to the movie ticket.

339
00:18:45.316 --> 00:18:46.816 A:middle
It has more value.

340
00:18:47.456 --> 00:18:51.206 A:middle
You don't want people just
generating and stealing this,

341
00:18:51.206 --> 00:18:52.726 A:middle
you know, left and right.

342
00:18:53.006 --> 00:18:54.496 A:middle
You got to protect
it a little bit.

343
00:18:55.456 --> 00:18:59.346 A:middle
But at the same time if you got
out there, if you know big deal,

344
00:18:59.506 --> 00:19:01.076 A:middle
it wouldn't-- it wouldn't
be the end of the world.

345
00:19:02.196 --> 00:19:06.436 A:middle
And finally, you kind of have
the gold vault of passes.

346
00:19:06.436 --> 00:19:10.166 A:middle
I was imagining boarding
passes would be in this.

347
00:19:11.156 --> 00:19:14.756 A:middle
You really don't want people
stealing them because they tend

348
00:19:14.756 --> 00:19:16.306 A:middle
to have quite a bit of value

349
00:19:16.936 --> 00:19:19.856 A:middle
and not only is the value
in one of the passes.

350
00:19:20.816 --> 00:19:25.316 A:middle
Not only is the value in all of
the boarding passes of that--

351
00:19:25.316 --> 00:19:26.996 A:middle
or that exist in Passbook.

352
00:19:27.316 --> 00:19:31.676 A:middle
But actually those services are
protecting all boarding passes

353
00:19:31.676 --> 00:19:33.456 A:middle
that exists very likely, right?

354
00:19:33.456 --> 00:19:38.446 A:middle
They have access to systems that
can see all boarding passes.

355
00:19:38.446 --> 00:19:41.476 A:middle
So, it's supper important
as you increase in value

356
00:19:41.736 --> 00:19:43.696 A:middle
that you spend more
time thinking about some

357
00:19:43.696 --> 00:19:46.326 A:middle
of the web services and tricks
we'll talk about later thinking

358
00:19:46.326 --> 00:19:48.886 A:middle
about reliability,
scalability and performance.

359
00:19:51.256 --> 00:19:57.676 A:middle
Uniqueness, a coupon can
be used my multiple people,

360
00:19:57.676 --> 00:19:59.696 A:middle
can be used multiple times.

361
00:20:00.586 --> 00:20:02.306 A:middle
There's really no
sense of counting.

362
00:20:02.306 --> 00:20:05.226 A:middle
There's no sense of
checking that much.

363
00:20:05.226 --> 00:20:10.356 A:middle
You could almost put the
value within the pass itself.

364
00:20:10.466 --> 00:20:12.896 A:middle
So, that is much easier to do

365
00:20:12.896 --> 00:20:14.526 A:middle
than let's say a
membership card.

366
00:20:15.886 --> 00:20:18.766 A:middle
A membership card might be
used by a single household

367
00:20:18.766 --> 00:20:22.076 A:middle
or a single family but
it's used many times.

368
00:20:22.616 --> 00:20:24.996 A:middle
And your systems might

369
00:20:24.996 --> 00:20:27.386 A:middle
in the backend be doing some
really advanced statistics

370
00:20:27.386 --> 00:20:29.616 A:middle
and processing on every use.

371
00:20:30.426 --> 00:20:33.256 A:middle
But if you miss one
use, if for some reason,

372
00:20:33.306 --> 00:20:36.256 A:middle
you received an event that says
"Oh, I need to use this now

373
00:20:36.256 --> 00:20:39.356 A:middle
and you couldn't actually
serve all the data,

374
00:20:39.356 --> 00:20:40.266 A:middle
it wouldn't be a big deal."

375
00:20:40.796 --> 00:20:43.856 A:middle
And then there's the
quantified use category.

376
00:20:45.276 --> 00:20:48.146 A:middle
The quantified use is
all about taking score

377
00:20:48.146 --> 00:20:51.566 A:middle
and counting every single
use a gift card is perfect

378
00:20:51.566 --> 00:20:52.236 A:middle
for this, right?

379
00:20:52.826 --> 00:20:56.966 A:middle
A gift card, you actually
decrement that value.

380
00:20:56.966 --> 00:20:59.236 A:middle
You never want to
over decrement, right,

381
00:20:59.236 --> 00:21:01.206 A:middle
but unless you want to give
some things away for free.

382
00:21:01.636 --> 00:21:03.826 A:middle
So, as a uniqueness increases--

383
00:21:04.966 --> 00:21:08.616 A:middle
sorry, as it becomes less unique
it's going to be more complex.

384
00:21:08.616 --> 00:21:12.546 A:middle
It's going to take a little bit
more time to build that pass.

385
00:21:12.736 --> 00:21:13.996 A:middle
Static versus dynamic.

386
00:21:15.276 --> 00:21:17.506 A:middle
I don't know how many of
guys have one of these.

387
00:21:17.506 --> 00:21:20.206 A:middle
The little blue social
security cards and they're

388
00:21:20.286 --> 00:21:22.906 A:middle
like there's nothing
on it except the number

389
00:21:22.906 --> 00:21:23.836 A:middle
and it looks really cheap.

390
00:21:24.776 --> 00:21:26.626 A:middle
Well, it's just a
piece of information

391
00:21:26.626 --> 00:21:27.806 A:middle
and the pass can be exactly

392
00:21:27.806 --> 00:21:29.816 A:middle
that can just be a
piece of information.

393
00:21:30.026 --> 00:21:32.736 A:middle
And the simpler it is if
it's just informational,

394
00:21:34.736 --> 00:21:36.446 A:middle
then it's much easier to write.

395
00:21:37.496 --> 00:21:41.076 A:middle
As you move up, maybe you're
changing one state or one field

396
00:21:41.076 --> 00:21:43.996 A:middle
in the pass [inaudible],
it might be an event

397
00:21:43.996 --> 00:21:46.386 A:middle
and you're kind of remind
somebody about an event

398
00:21:46.696 --> 00:21:49.086 A:middle
and it's going to get a
little bit more advanced.

399
00:21:50.376 --> 00:21:53.646 A:middle
But the multi-state pass where
you're updating multiple pieces

400
00:21:53.646 --> 00:21:56.336 A:middle
within the pass and I thought
a score board was a perfect

401
00:21:56.336 --> 00:21:57.566 A:middle
representation of this.

402
00:21:58.216 --> 00:21:59.646 A:middle
You're counting the
number of innings,

403
00:21:59.646 --> 00:22:01.036 A:middle
you're counting the
number of balls

404
00:22:01.036 --> 00:22:03.466 A:middle
or you're counting the
score, all these are kind

405
00:22:03.466 --> 00:22:05.856 A:middle
of dynamically updating
as needed.

406
00:22:06.376 --> 00:22:09.756 A:middle
The more states you have
to update on your pass,

407
00:22:09.756 --> 00:22:12.676 A:middle
the more time you need to spend.

408
00:22:12.676 --> 00:22:13.116 A:middle
OK, scale.

409
00:22:13.116 --> 00:22:18.976 A:middle
Scale is about the number
of passes that you have

410
00:22:19.646 --> 00:22:23.956 A:middle
or the number of locations that
you have or even the number

411
00:22:23.956 --> 00:22:25.526 A:middle
or points of sales
that you have.

412
00:22:26.086 --> 00:22:28.886 A:middle
So, it could just be that
you have a few passes.

413
00:22:28.886 --> 00:22:31.136 A:middle
You're maybe a mom and
pop shop and you're kind

414
00:22:31.136 --> 00:22:32.686 A:middle
of in the center category

415
00:22:32.686 --> 00:22:35.516 A:middle
where you have a few
passes not too big of a deal

416
00:22:35.836 --> 00:22:37.996 A:middle
or maybe you're chain,
you have even more passes.

417
00:22:38.716 --> 00:22:41.226 A:middle
Or you're a huge
enterprise and you have a ton

418
00:22:41.226 --> 00:22:44.136 A:middle
of passes you have to worry
everyday about reliability,

419
00:22:44.216 --> 00:22:45.566 A:middle
scalability and performance.

420
00:22:46.836 --> 00:22:50.466 A:middle
Another thing, another one
I mentioned was the point

421
00:22:50.466 --> 00:22:52.066 A:middle
of sales devices.

422
00:22:52.176 --> 00:22:54.456 A:middle
Let's say you're in a department
store and you're downstairs

423
00:22:54.456 --> 00:22:56.036 A:middle
and you're buying shoes.

424
00:22:56.816 --> 00:22:59.346 A:middle
And in the meantime
you're spouse is upstairs,

425
00:22:59.816 --> 00:23:02.816 A:middle
they're buying a shirt,
if you're using that pass

426
00:23:03.106 --> 00:23:07.336 A:middle
in both places you need to
make sure that data is correct

427
00:23:07.336 --> 00:23:09.076 A:middle
at the moment that pass is used.

428
00:23:10.326 --> 00:23:11.006 A:middle
OK, scale.

429
00:23:11.726 --> 00:23:13.846 A:middle
You with me still?

430
00:23:14.006 --> 00:23:16.766 A:middle
Systems integration, the last
one on the complexity scale,

431
00:23:17.496 --> 00:23:20.546 A:middle
the more systems you
need to integrate with,

432
00:23:21.256 --> 00:23:22.386 A:middle
the harder this is going to be.

433
00:23:22.876 --> 00:23:26.216 A:middle
So, if you can reimagine you're
Ecosystem, if you can say,

434
00:23:26.516 --> 00:23:28.626 A:middle
"I only need to support
the iPhone

435
00:23:28.626 --> 00:23:31.626 A:middle
or the iPod Touch"
it's much easier

436
00:23:31.626 --> 00:23:33.626 A:middle
to bring Passbook in, right?

437
00:23:34.476 --> 00:23:37.326 A:middle
But if you have to support
many electronic devices

438
00:23:37.446 --> 00:23:42.896 A:middle
like the desktop when Sonal
had to purchase on the web.

439
00:23:43.796 --> 00:23:45.776 A:middle
You're going to have to think
about a little bit more.

440
00:23:45.936 --> 00:23:47.706 A:middle
You're going to have
to make sure

441
00:23:47.706 --> 00:23:49.086 A:middle
that you cover all your bases

442
00:23:49.086 --> 00:23:53.006 A:middle
and you support those
users hopefully as richly.

443
00:23:54.116 --> 00:23:56.916 A:middle
And then of course the
most complicated one

444
00:23:56.916 --> 00:24:01.196 A:middle
when you still have the physical
gift cards to support you have

445
00:24:01.416 --> 00:24:04.066 A:middle
to make sure you keep
those users in mind.

446
00:24:04.696 --> 00:24:05.876 A:middle
OK, systems integration.

447
00:24:05.876 --> 00:24:07.306 A:middle
That was the last facet.

448
00:24:07.616 --> 00:24:12.116 A:middle
So, we said value,
static versus dynamic,

449
00:24:12.616 --> 00:24:14.516 A:middle
scale, what's the last one?

450
00:24:14.516 --> 00:24:19.506 A:middle
Come on you guys,
systems integration

451
00:24:19.506 --> 00:24:21.006 A:middle
and I think I missed
one but that's OK.

452
00:24:21.426 --> 00:24:22.326 A:middle
I'm glad you're still awake.

453
00:24:23.456 --> 00:24:25.846 A:middle
Don't assume, don't assume

454
00:24:26.226 --> 00:24:32.026 A:middle
that complexity equals
better because it doesn't.

455
00:24:32.586 --> 00:24:36.206 A:middle
You guys can have great passes
you can enrich the user's

456
00:24:36.206 --> 00:24:39.096 A:middle
experience with the
simplest of passes.

457
00:24:39.616 --> 00:24:42.356 A:middle
We were in Passbook
labs earlier and story

458
00:24:42.356 --> 00:24:44.626 A:middle
after story, people
are doing it.

459
00:24:44.926 --> 00:24:46.076 A:middle
So, I encourage you.

460
00:24:47.016 --> 00:24:48.096 A:middle
Create a pass.

461
00:24:48.486 --> 00:24:50.176 A:middle
Figure out what you
can do that enriches

462
00:24:50.176 --> 00:24:51.186 A:middle
that user's experiences.

463
00:24:52.536 --> 00:24:54.596 A:middle
OK, that was where
my summary slide was.

464
00:24:54.866 --> 00:25:01.156 A:middle
Web services tips and tricks.

465
00:25:01.266 --> 00:25:09.476 A:middle
OK, reviewing the
pass asset sizes.

466
00:25:10.376 --> 00:25:15.226 A:middle
This is the green category
in which we're telling you

467
00:25:15.226 --> 00:25:21.366 A:middle
if you're in the basic area, you
should-- if you're in the basic,

468
00:25:21.366 --> 00:25:22.926 A:middle
you should do these 4 things.

469
00:25:23.686 --> 00:25:26.706 A:middle
So, review your pass
asset sizes,

470
00:25:26.706 --> 00:25:30.846 A:middle
adhere to if modified since,
implement logging endpoints

471
00:25:30.846 --> 00:25:32.666 A:middle
and expect dependency outages.

472
00:25:33.406 --> 00:25:38.056 A:middle
What does it mean to review
your pass asset sizes?

473
00:25:39.506 --> 00:25:43.186 A:middle
Performance and scalability
is super important at Apple,

474
00:25:44.096 --> 00:25:48.626 A:middle
often times before we have
a launch we'll test and test

475
00:25:48.626 --> 00:25:56.086 A:middle
and test until we know that
our systems will stay up.

476
00:25:56.086 --> 00:25:59.336 A:middle
And we were doing this in
QA over and over and over

477
00:26:00.006 --> 00:26:05.516 A:middle
and suddenly we were struggling,
we were getting these slow,

478
00:26:05.516 --> 00:26:09.326 A:middle
slow response time, it's taking
forever to zip up our files.

479
00:26:09.416 --> 00:26:14.286 A:middle
We looked a little
deeper and we found

480
00:26:14.286 --> 00:26:16.416 A:middle
out our asset sizes had changed.

481
00:26:16.416 --> 00:26:20.656 A:middle
They went from 4 kilobytes
to 280 kilobytes, what?

482
00:26:21.196 --> 00:26:21.876 A:middle
Right? What?

483
00:26:22.646 --> 00:26:24.906 A:middle
So, we have publishers
and they have the ability

484
00:26:24.906 --> 00:26:26.646 A:middle
to change our assets on a dime.

485
00:26:26.886 --> 00:26:29.726 A:middle
They decided they wanted
print quality and something

486
00:26:29.726 --> 00:26:31.756 A:middle
that wasn't going to
show them that quality.

487
00:26:32.536 --> 00:26:38.826 A:middle
So, what I highly recommend
you do, size your image assets,

488
00:26:39.596 --> 00:26:42.306 A:middle
make sure that they
don't exceed a limit

489
00:26:43.476 --> 00:26:46.096 A:middle
and log them as necessary.

490
00:26:46.546 --> 00:26:50.996 A:middle
Number 2, adhere to
if modified sense.

491
00:26:52.206 --> 00:26:57.976 A:middle
This is an RFC 2616, it
let's your clients make

492
00:26:57.976 --> 00:26:59.086 A:middle
conditional requests.

493
00:27:00.696 --> 00:27:05.796 A:middle
Basically, let's say-- let's
say there's this awesome WWDC

494
00:27:05.796 --> 00:27:10.816 A:middle
exclusive party pass and if
anybody was going to have it

495
00:27:11.066 --> 00:27:14.716 A:middle
on my team, it'd be Alberto,
he is the partier of our team

496
00:27:14.716 --> 00:27:18.316 A:middle
and so he gets his great
pass, and he's probably--

497
00:27:18.316 --> 00:27:20.736 A:middle
he last updated at noon and
he's probably sitting here

498
00:27:20.736 --> 00:27:23.136 A:middle
and thinking I've heard this
presentation a thousand times.

499
00:27:23.386 --> 00:27:24.886 A:middle
He's looking at the
back of the pass, right?

500
00:27:24.886 --> 00:27:27.516 A:middle
And he's like, it shows
this pass by the way,

501
00:27:27.556 --> 00:27:29.996 A:middle
shows all the parties that
are happening and when,

502
00:27:29.996 --> 00:27:31.596 A:middle
which hotel rooms and so forth.

503
00:27:31.596 --> 00:27:34.206 A:middle
So, he's pulling down,
so he pulls it down.

504
00:27:34.206 --> 00:27:36.826 A:middle
He hasn't updated since
12, that request comes

505
00:27:36.826 --> 00:27:39.066 A:middle
over to our servers
and on the servers,

506
00:27:39.066 --> 00:27:41.256 A:middle
we look at that database
and say for this pass,

507
00:27:41.426 --> 00:27:43.816 A:middle
has there been any updates?

508
00:27:43.816 --> 00:27:45.836 A:middle
Has there been any
new parties added?

509
00:27:46.046 --> 00:27:48.926 A:middle
And if there has been,
scoop up all the contents,

510
00:27:48.926 --> 00:27:52.486 A:middle
make that PK pass file,
get it back to Alberto,

511
00:27:52.486 --> 00:27:54.406 A:middle
and Alberto is like,
"Yes, score,

512
00:27:54.406 --> 00:27:56.766 A:middle
there's another party" right?

513
00:27:57.956 --> 00:28:01.216 A:middle
And then five minutes
pass, he slips that pass

514
00:28:01.216 --> 00:28:02.476 A:middle
over and he pulls it down.

515
00:28:02.896 --> 00:28:06.886 A:middle
Request comes back to the
server, I look at the database,

516
00:28:06.886 --> 00:28:07.946 A:middle
and there's nothing new.

517
00:28:08.326 --> 00:28:10.526 A:middle
Sorry, Alberto, I'm
going to send you a 304--

518
00:28:10.526 --> 00:28:13.706 A:middle
I'm not going to spend any time
building your PK pass file.

519
00:28:13.916 --> 00:28:15.436 A:middle
I'm not going to
waste your bandwidth.

520
00:28:15.936 --> 00:28:18.076 A:middle
I'm just going to tell
you, you have the latest.

521
00:28:18.846 --> 00:28:21.616 A:middle
That's what adhere to if
modified sense and you can kind

522
00:28:21.616 --> 00:28:26.916 A:middle
of see this the request and
then the response starts,

523
00:28:26.916 --> 00:28:28.796 A:middle
you first respond with a 200

524
00:28:29.146 --> 00:28:34.946 A:middle
and if it's not modified
you return a 304.

525
00:28:35.136 --> 00:28:36.586 A:middle
OK, implement logging endpoints.

526
00:28:39.556 --> 00:28:42.616 A:middle
Implementing the logging
endpoints can sometimes be

527
00:28:42.616 --> 00:28:48.416 A:middle
forgettable, often times
our first kind of shot

528
00:28:48.416 --> 00:28:52.406 A:middle
at building these things as to
get all the basics down, right?

529
00:28:52.406 --> 00:28:55.366 A:middle
There are 5 endpoints
and you'll do the first 4

530
00:28:55.366 --> 00:28:56.666 A:middle
and you'll get those
knocked out.

531
00:28:57.386 --> 00:29:01.166 A:middle
But I highly recommend that you
make sure you've implemented

532
00:29:02.056 --> 00:29:02.586 A:middle
the log.

533
00:29:04.236 --> 00:29:05.696 A:middle
What will this do for you?

534
00:29:06.096 --> 00:29:09.536 A:middle
This will send you
human-readable information

535
00:29:09.876 --> 00:29:12.456 A:middle
about mistakes in
your implementation.

536
00:29:13.256 --> 00:29:16.726 A:middle
We spent so much time paying
people to give us feedback,

537
00:29:16.886 --> 00:29:18.226 A:middle
these usability studies.

538
00:29:18.226 --> 00:29:20.946 A:middle
We give them lots of money
to know more information.

539
00:29:21.746 --> 00:29:25.386 A:middle
But this is free feedback,
so why wouldn't we use it?

540
00:29:26.586 --> 00:29:28.316 A:middle
Implement the logging endpoint.

541
00:29:28.856 --> 00:29:34.136 A:middle
OK, number 4, expect
dependency outages.

542
00:29:34.136 --> 00:29:40.616 A:middle
If you have a service
out there, what happens

543
00:29:40.616 --> 00:29:41.786 A:middle
when that service goes down?

544
00:29:43.236 --> 00:29:46.146 A:middle
Are you in good shape because
you really put a load balancer

545
00:29:46.146 --> 00:29:47.806 A:middle
in front of it and
you actually have 2,

546
00:29:47.806 --> 00:29:49.646 A:middle
so it's no big deal
if one goes down.

547
00:29:50.876 --> 00:29:52.466 A:middle
If you can, try to make--

548
00:29:52.466 --> 00:29:55.546 A:middle
put multiple instances of
your web services out there.

549
00:29:55.716 --> 00:30:00.976 A:middle
For us, we talk to something
called Location Services.

550
00:30:01.056 --> 00:30:07.716 A:middle
Location Services is-- it gives
us the 10 nearest Apple Stores

551
00:30:07.716 --> 00:30:09.586 A:middle
or it actually gives us
all the Apple Stores.

552
00:30:10.186 --> 00:30:15.276 A:middle
But we go to-- we go and
ask location services

553
00:30:15.276 --> 00:30:17.336 A:middle
when we generate a
pass, "Hey, you know,

554
00:30:17.336 --> 00:30:19.756 A:middle
where are my 10 nearest
Apple Stores?

555
00:30:20.376 --> 00:30:24.626 A:middle
We then can cache
that response locally

556
00:30:25.526 --> 00:30:29.506 A:middle
so that every time the request
comes in to build that pass,

557
00:30:29.506 --> 00:30:31.376 A:middle
we don't have to check
Location Services.

558
00:30:32.286 --> 00:30:34.086 A:middle
And where this is
super helpful is

559
00:30:34.086 --> 00:30:35.866 A:middle
when Location Services
goes down.

560
00:30:38.416 --> 00:30:40.626 A:middle
Did you need Location Services?

561
00:30:41.306 --> 00:30:44.216 A:middle
Could you have survived with
just putting in a long cache

562
00:30:44.216 --> 00:30:46.526 A:middle
so that if Location
Services goes down,

563
00:30:47.036 --> 00:30:48.436 A:middle
it's not that big of a deal.

564
00:30:48.436 --> 00:30:50.326 A:middle
It doesn't have to have
a 100 percent uptime.

565
00:30:50.716 --> 00:30:52.596 A:middle
And even better, show
this with the gray,

566
00:30:53.156 --> 00:30:54.916 A:middle
if you can have a fullback file.

567
00:30:55.396 --> 00:30:58.036 A:middle
So, we could just have a
fullback of all the locations

568
00:30:58.446 --> 00:31:00.976 A:middle
that Apple had at
the time of launch.

569
00:31:01.316 --> 00:31:04.986 A:middle
At least we were able to serve
the user with something, right?

570
00:31:04.986 --> 00:31:06.736 A:middle
I mean how many of you want

571
00:31:06.736 --> 00:31:08.886 A:middle
to hear I couldn't get
my Apple Store Gift Card

572
00:31:08.886 --> 00:31:11.826 A:middle
because they couldn't
find the nearest stores,

573
00:31:11.906 --> 00:31:13.106 A:middle
it's just ridiculous, right?

574
00:31:14.016 --> 00:31:15.866 A:middle
So, pass should serve--

575
00:31:15.866 --> 00:31:18.236 A:middle
be served with the
bare minimum assets,

576
00:31:18.736 --> 00:31:20.786 A:middle
even when dependencies
are not responding.

577
00:31:22.076 --> 00:31:25.576 A:middle
And set up default back
up in data if you have to.

578
00:31:26.596 --> 00:31:28.786 A:middle
Do your best to serve
every request,

579
00:31:29.696 --> 00:31:32.206 A:middle
but don't create
unnecessary dependencies.

580
00:31:32.876 --> 00:31:41.406 A:middle
OK, tips in the intermediate
category.

581
00:31:42.446 --> 00:31:43.996 A:middle
Validating your origin.

582
00:31:44.596 --> 00:31:52.346 A:middle
It's not sufficient to simply
test, "Hey, is this pass valid

583
00:31:52.746 --> 00:31:53.876 A:middle
from a data standpoint?"

584
00:31:54.776 --> 00:31:57.876 A:middle
So, what I mean by that is
for us, we have gift card

585
00:31:58.356 --> 00:32:02.336 A:middle
and we could just for every
request, simply test, "Hey,

586
00:32:02.336 --> 00:32:05.266 A:middle
is this gift card number valid?

587
00:32:05.506 --> 00:32:06.546 A:middle
Does it have value?

588
00:32:07.356 --> 00:32:08.976 A:middle
But my recommendation is

589
00:32:08.976 --> 00:32:13.326 A:middle
that you step back a little
bit before even checking the

590
00:32:13.326 --> 00:32:16.236 A:middle
contents of the pass,
check who's the author.

591
00:32:16.236 --> 00:32:18.206 A:middle
Are you the origin?

592
00:32:19.766 --> 00:32:22.816 A:middle
The last thing you want to
be is a movie card generator

593
00:32:23.296 --> 00:32:24.906 A:middle
or a gift card checker, right?

594
00:32:25.636 --> 00:32:28.926 A:middle
If you check the signature
before you even serve the

595
00:32:28.926 --> 00:32:31.926 A:middle
request, you won't have
people out there building

596
00:32:32.356 --> 00:32:35.296 A:middle
or getting a valid gift card
for instance in our case,

597
00:32:35.526 --> 00:32:37.226 A:middle
and starting to tweak, right?

598
00:32:37.226 --> 00:32:40.156 A:middle
They're tweaking each of those
values to figure out the form

599
00:32:40.156 --> 00:32:41.646 A:middle
of your system and
understand it more.

600
00:32:42.316 --> 00:32:46.276 A:middle
If you sign the pass
first, if you sign the--

601
00:32:46.576 --> 00:32:47.676 A:middle
and I'm going to show
you how to do this,

602
00:32:47.676 --> 00:32:50.546 A:middle
the authentication token
first, you're going to see

603
00:32:50.546 --> 00:32:52.156 A:middle
that you can protect
yourself a lot more.

604
00:32:53.356 --> 00:32:56.366 A:middle
OK, so how many of guys remember
the authentication token?

605
00:32:56.366 --> 00:32:57.286 A:middle
Do you guys remember this?

606
00:32:57.896 --> 00:33:00.806 A:middle
A few of you, oh, that's
like 10 percent, 15 percent.

607
00:33:00.806 --> 00:33:02.656 A:middle
OK, authentication token.

608
00:33:03.546 --> 00:33:12.086 A:middle
It's in the pass.json, and
it actually comes over on 3

609
00:33:12.086 --> 00:33:17.836 A:middle
of these requests, register
a device, unregister a device

610
00:33:18.816 --> 00:33:20.216 A:middle
and get the latest version.

611
00:33:21.436 --> 00:33:25.546 A:middle
That means on all 3 of these
request, if you know how

612
00:33:25.546 --> 00:33:28.696 A:middle
to check your signature,
you don't even have

613
00:33:28.696 --> 00:33:32.476 A:middle
to serve any part of that
request unless you know it came

614
00:33:32.476 --> 00:33:32.766 A:middle
from you.

615
00:33:32.766 --> 00:33:35.646 A:middle
How am I to do this?

616
00:33:36.536 --> 00:33:42.096 A:middle
Try using HMAC, pick a
message, any message, HMAC it,

617
00:33:42.096 --> 00:33:45.876 A:middle
append it to the
front, maybe sign

618
00:33:46.146 --> 00:33:49.836 A:middle
or maybe add a few characters,
some constants here and there,

619
00:33:49.836 --> 00:33:51.306 A:middle
so you know how to recognize it.

620
00:33:51.846 --> 00:33:55.056 A:middle
And now, put that in your
authentication token.

621
00:33:58.416 --> 00:34:00.196 A:middle
HMAC is super easy to do.

622
00:34:00.196 --> 00:34:03.036 A:middle
It's available on practically
any language you're probably

623
00:34:03.036 --> 00:34:05.616 A:middle
going to write a web
service implementation in.

624
00:34:06.016 --> 00:34:10.626 A:middle
Ruby has a PHP, Python, Java,
it's available in the language

625
00:34:10.626 --> 00:34:13.085 A:middle
or some third party library,

626
00:34:13.085 --> 00:34:20.626 A:middle
Bouncy Castle is a
good example of that.

627
00:34:21.255 --> 00:34:23.746 A:middle
OK, validate significant
contents.

628
00:34:25.426 --> 00:34:29.726 A:middle
Anyone can create a
pass and with that said,

629
00:34:29.726 --> 00:34:32.306 A:middle
the pass itself cannot
be authoritative.

630
00:34:32.306 --> 00:34:35.206 A:middle
In fact, even if they
didn't create the pass

631
00:34:35.206 --> 00:34:36.795 A:middle
and it just hasn't
updated recently,

632
00:34:36.795 --> 00:34:39.815 A:middle
you may not have the latest
gift card value, right?

633
00:34:41.076 --> 00:34:43.426 A:middle
So, make sure you check
that source of truth.

634
00:34:43.426 --> 00:34:46.186 A:middle
Go back and check
gift card services

635
00:34:46.186 --> 00:34:48.946 A:middle
or whatever your
equivalent is, check it.

636
00:34:51.936 --> 00:34:55.456 A:middle
Number 3, leveraging caching,

637
00:34:56.025 --> 00:35:00.636 A:middle
cache as much downstream
information as possible.

638
00:35:01.736 --> 00:35:03.576 A:middle
We talked about Location
Services.

639
00:35:03.576 --> 00:35:05.856 A:middle
We have the ability of
caching Location Services.

640
00:35:06.296 --> 00:35:09.136 A:middle
Cache or product
services, if for instance,

641
00:35:09.436 --> 00:35:13.166 A:middle
a pass is also represented by
associated product, cache that.

642
00:35:13.456 --> 00:35:14.756 A:middle
Cache your image services,

643
00:35:14.756 --> 00:35:17.486 A:middle
so if you use an image
service, like Scene7.

644
00:35:18.576 --> 00:35:21.176 A:middle
Take those images and
put them in local cache.

645
00:35:21.326 --> 00:35:22.956 A:middle
Do not fetch them
on every request.

646
00:35:22.956 --> 00:35:25.296 A:middle
I highly recommend
not to fetch them.

647
00:35:26.276 --> 00:35:28.886 A:middle
You can even cache your
encryption and decryption

648
00:35:28.886 --> 00:35:30.236 A:middle
of your authentication token.

649
00:35:30.236 --> 00:35:34.686 A:middle
And then the last one which I
think is kind of interesting,

650
00:35:35.136 --> 00:35:37.406 A:middle
consider caching
the PK pass file.

651
00:35:38.936 --> 00:35:41.806 A:middle
Remember that WWDC
exclusive party pass

652
00:35:41.806 --> 00:35:42.846 A:middle
that I was telling you about?

653
00:35:43.986 --> 00:35:45.426 A:middle
Well, if that's going around,

654
00:35:46.186 --> 00:35:48.816 A:middle
guaranteed Stefan [phonetic]
would have gotten it.

655
00:35:48.816 --> 00:35:52.886 A:middle
Now, Stefan, he knows everyone
and he's definitely going

656
00:35:52.886 --> 00:35:54.856 A:middle
to share with iMessage his pass.

657
00:35:55.026 --> 00:35:57.966 A:middle
So, he's going to say, "This
is all the people I know

658
00:35:57.966 --> 00:36:00.286 A:middle
at a queue listed,
yes, yes, OK."

659
00:36:00.816 --> 00:36:04.396 A:middle
Forming out the WWDC party
pass and all of them are going

660
00:36:04.396 --> 00:36:06.386 A:middle
to start requesting
updates all at once.

661
00:36:07.396 --> 00:36:11.686 A:middle
Now, if I was smart, and I
cache the entire PK pass file,

662
00:36:12.036 --> 00:36:15.966 A:middle
I could recognize based on
the parameters of the URL

663
00:36:16.336 --> 00:36:19.786 A:middle
that I just need to scoop up
my PK pass file, and serve it.

664
00:36:19.906 --> 00:36:23.766 A:middle
I didn't spend any time
zipping that pass file up.

665
00:36:24.936 --> 00:36:26.366 A:middle
Cool, huh?

666
00:36:27.776 --> 00:36:32.496 A:middle
OK. Four, in the intermediate
category, monitoring.

667
00:36:33.986 --> 00:36:36.356 A:middle
Be the first to know when
your service is down.

668
00:36:37.446 --> 00:36:40.896 A:middle
I hate it and hopefully, and it
happens rarely, but I hate it

669
00:36:40.896 --> 00:36:43.596 A:middle
when my boss comes in and says,
"What's going on with this?"

670
00:36:43.686 --> 00:36:48.856 A:middle
If you can know that your pass,
your web services have gone

671
00:36:48.856 --> 00:36:50.996 A:middle
down first, it's a huge win.

672
00:36:51.256 --> 00:36:56.126 A:middle
There is so many monitoring
systems out there, Site24x7.

673
00:36:56.126 --> 00:36:58.966 A:middle
They allow you to send
request, HTTP request,

674
00:36:59.016 --> 00:37:02.086 A:middle
and you can configure
everything.

675
00:37:02.086 --> 00:37:04.896 A:middle
You can configure the post,
you can configure the headers

676
00:37:04.896 --> 00:37:08.386 A:middle
and then on the response,
you can check, is it a 200?

677
00:37:08.386 --> 00:37:14.466 A:middle
Is the pass-- is it a
correct response type?

678
00:37:14.656 --> 00:37:17.466 A:middle
So, monitor from
external systems and then

679
00:37:17.466 --> 00:37:19.476 A:middle
when systems go down,
you're going to get a text,

680
00:37:19.476 --> 00:37:21.606 A:middle
and you might be out but
you're the first person on it

681
00:37:21.606 --> 00:37:25.246 A:middle
because you know it happened.

682
00:37:25.246 --> 00:37:28.296 A:middle
Internal logging, this
one is really easy,

683
00:37:28.796 --> 00:37:32.076 A:middle
especially if you can add
log aggregation like Splunk.

684
00:37:32.506 --> 00:37:36.646 A:middle
But log things that matter
whether it's a logging endpoints

685
00:37:36.646 --> 00:37:37.416 A:middle
that came in.

686
00:37:38.026 --> 00:37:39.596 A:middle
The asset sizes we talked

687
00:37:39.596 --> 00:37:44.156 A:middle
about when you start
exceeding a level, log that.

688
00:37:44.156 --> 00:37:47.726 A:middle
Another one, if your
certificate is about to expire,

689
00:37:47.726 --> 00:37:49.036 A:middle
you guys get one year, right?

690
00:37:49.866 --> 00:37:51.046 A:middle
And sometimes we don't think

691
00:37:51.046 --> 00:37:53.726 A:middle
about these things a year
later, so start to log.

692
00:37:53.826 --> 00:37:58.096 A:middle
And then when you hit a certain
size or maybe get a daily digest

693
00:37:58.096 --> 00:38:00.416 A:middle
of the logs, you
get top 10 logs.

694
00:38:00.896 --> 00:38:03.686 A:middle
This will help you monitor
and keep your systems healthy

695
00:38:03.686 --> 00:38:04.846 A:middle
without a lot of effort.

696
00:38:05.786 --> 00:38:08.986 A:middle
Of course there's internal
monitoring also, you can Nagios,

697
00:38:08.986 --> 00:38:09.986 A:middle
make sure those bits are up.

698
00:38:10.626 --> 00:38:14.416 A:middle
But think about monitoring,
so those were kind

699
00:38:14.416 --> 00:38:17.296 A:middle
of the intermediate items.

700
00:38:17.946 --> 00:38:24.856 A:middle
Tips for the advanced, the first
one I have is rate limiting.

701
00:38:26.206 --> 00:38:31.396 A:middle
Rate limiting is all about
making sure you don't

702
00:38:31.396 --> 00:38:34.986 A:middle
over serve the request
that are coming in

703
00:38:34.986 --> 00:38:39.076 A:middle
or unnecessarily serve the
request that are coming in.

704
00:38:39.896 --> 00:38:41.966 A:middle
So, if you have a
denial of service attack,

705
00:38:42.486 --> 00:38:46.096 A:middle
and you can identify, hey, this
pattern of request is too fast.

706
00:38:47.156 --> 00:38:48.976 A:middle
You can pull back, and you
can just let them drop.

707
00:38:49.636 --> 00:38:52.366 A:middle
And your whole system
can set up and continue

708
00:38:52.366 --> 00:38:58.176 A:middle
to serve valid requests without
kind of going down, kind--

709
00:38:58.176 --> 00:39:00.546 A:middle
attempting to serve all
these invalid requests.

710
00:39:01.026 --> 00:39:04.086 A:middle
It protects you from a
denial of service attack

711
00:39:04.086 --> 00:39:05.436 A:middle
and a brute force attack.

712
00:39:05.836 --> 00:39:09.256 A:middle
You can rate limit on a serial
number, although be careful now

713
00:39:09.256 --> 00:39:10.826 A:middle
that sharing is going
to be prevalent.

714
00:39:10.826 --> 00:39:13.366 A:middle
You want to make sure it makes
sense for your pass type.

715
00:39:14.486 --> 00:39:17.986 A:middle
You can rate limit on an
IP, be careful with that

716
00:39:17.986 --> 00:39:20.066 A:middle
because probably a lot of
people have passes in WWDC

717
00:39:20.066 --> 00:39:21.486 A:middle
and the last thing you want

718
00:39:21.486 --> 00:39:24.376 A:middle
to do is shutdown
request coming from WWDC.

719
00:39:25.186 --> 00:39:31.076 A:middle
But think about rate limiting,
process asynchronously.

720
00:39:32.456 --> 00:39:36.186 A:middle
When a request comes
in, you want to serve

721
00:39:36.186 --> 00:39:38.246 A:middle
that request just
quickly as possible.

722
00:39:38.976 --> 00:39:43.116 A:middle
The more time you spend doing
downstream things and holding

723
00:39:43.116 --> 00:39:45.846 A:middle
that connection, the less
people you can serve,

724
00:39:46.126 --> 00:39:47.976 A:middle
the more systems you have to put

725
00:39:48.076 --> 00:39:49.836 A:middle
up to serve all the
incoming request.

726
00:39:51.026 --> 00:39:54.326 A:middle
So, if you go out and you
try to pre-warm your caches,

727
00:39:54.326 --> 00:39:58.136 A:middle
get all the information you can
as soon as possible right even

728
00:39:58.136 --> 00:39:58.976 A:middle
when your system starts up.

729
00:39:59.626 --> 00:40:02.286 A:middle
So, for example like I said,

730
00:40:02.286 --> 00:40:04.096 A:middle
gift cards can be
associated for--

731
00:40:04.096 --> 00:40:06.456 A:middle
with a product, and that's
how when you're purchasing

732
00:40:06.456 --> 00:40:09.426 A:middle
in the store, the strip
looks very similar

733
00:40:09.426 --> 00:40:10.676 A:middle
to the original gift card.

734
00:40:11.536 --> 00:40:14.106 A:middle
What I can do is I can go
to product services as soon

735
00:40:14.106 --> 00:40:15.016 A:middle
as I start up and I say,

736
00:40:15.016 --> 00:40:17.336 A:middle
"Give me all the gift
cards that are out there.

737
00:40:18.076 --> 00:40:21.706 A:middle
And give me all the related
strips that are out" then

738
00:40:21.706 --> 00:40:23.586 A:middle
when the request comes in,

739
00:40:23.586 --> 00:40:26.816 A:middle
I'm not wasting time getting
those downstream items,

740
00:40:27.116 --> 00:40:31.756 A:middle
I'm just pulling them
from my local cache.

741
00:40:31.966 --> 00:40:36.126 A:middle
Logs. Writing to
disk is expensive.

742
00:40:36.656 --> 00:40:41.606 A:middle
If you allow every log
that comes in especially

743
00:40:41.606 --> 00:40:43.366 A:middle
on the endpoint to
write to disk,

744
00:40:43.436 --> 00:40:44.806 A:middle
you could be in a
dangerous spot.

745
00:40:45.326 --> 00:40:47.036 A:middle
So, if you throw it in memory

746
00:40:47.496 --> 00:40:50.576 A:middle
and you have a write behind the
disk, you're going to be able

747
00:40:50.576 --> 00:40:52.376 A:middle
to serve that request
a lot faster

748
00:40:52.376 --> 00:40:56.646 A:middle
without impacting the
rest of your systems.

749
00:40:56.736 --> 00:41:00.146 A:middle
Using a queue for push
notifications and this is

750
00:41:00.146 --> 00:41:04.196 A:middle
that callback update, so when
you find out that the pass needs

751
00:41:04.196 --> 00:41:08.606 A:middle
to be updated, instead of
holding that connection for us

752
00:41:08.606 --> 00:41:11.266 A:middle
from gift card services,
we can just say, "Yeah,

753
00:41:11.266 --> 00:41:13.396 A:middle
we got the request and
we drop it in a queue."

754
00:41:13.776 --> 00:41:16.946 A:middle
And then later on as soon
our systems are ready,

755
00:41:17.276 --> 00:41:19.496 A:middle
we just serve it to Push
Notification Service.

756
00:41:19.786 --> 00:41:21.456 A:middle
We don't have to wait to find

757
00:41:21.456 --> 00:41:24.056 A:middle
out that Apple Push Notification
service received the request.

758
00:41:24.556 --> 00:41:29.086 A:middle
There's no need to,
just drop it in a queue.

759
00:41:29.206 --> 00:41:33.626 A:middle
Avoid holding those connections,
those connections open as--

760
00:41:33.666 --> 00:41:36.116 A:middle
make it as short of
a period as possible.

761
00:41:37.436 --> 00:41:42.276 A:middle
OK, 3, leveraging
auth token as storage.

762
00:41:43.906 --> 00:41:45.886 A:middle
If you don't want to do this

763
00:41:45.886 --> 00:41:48.216 A:middle
or you don't understand
this, don't feel bad.

764
00:41:48.586 --> 00:41:50.726 A:middle
This is super cool
though, so pay attention.

765
00:41:51.346 --> 00:41:53.566 A:middle
These impacts performance
reliability

766
00:41:53.566 --> 00:41:55.946 A:middle
but the basic concept is here.

767
00:41:57.476 --> 00:42:01.586 A:middle
On our request, Apple
Store pass services needs

768
00:42:01.586 --> 00:42:04.236 A:middle
to take the serial number I
got from the pass and I need

769
00:42:04.236 --> 00:42:06.596 A:middle
to crosscheck and get the
gift card and the pin.

770
00:42:07.136 --> 00:42:09.826 A:middle
Because remember the gift
card is my common currency

771
00:42:09.826 --> 00:42:13.816 A:middle
with gift card services, so I
have to go, I got to go look

772
00:42:13.816 --> 00:42:18.766 A:middle
at my database, and find the
gift card and associated pin.

773
00:42:19.576 --> 00:42:22.976 A:middle
That means before
I can even check

774
00:42:23.556 --> 00:42:27.636 A:middle
if the gift card has value,
I've had to hit my database,

775
00:42:28.366 --> 00:42:30.986 A:middle
and we know database, talk
into a database can be slow.

776
00:42:32.156 --> 00:42:36.726 A:middle
So, one of the things you can do
is embed your gift card and pin

777
00:42:36.726 --> 00:42:37.976 A:middle
or your common currency

778
00:42:37.976 --> 00:42:40.406 A:middle
or whatever information
that's relevant

779
00:42:40.446 --> 00:42:43.606 A:middle
to you inside your
authentication token.

780
00:42:44.076 --> 00:42:46.276 A:middle
OK, so how many of you guys
remember authentication

781
00:42:46.276 --> 00:42:46.966 A:middle
token now?

782
00:42:48.226 --> 00:42:51.646 A:middle
Little bit more, OK.

783
00:42:51.646 --> 00:42:55.686 A:middle
[laughs] If you embed gift card,
the gift card number and the pin

784
00:42:55.856 --> 00:42:59.196 A:middle
in the authentication token,
you actually don't have

785
00:42:59.236 --> 00:43:03.186 A:middle
to ask your database
what is associated

786
00:43:03.186 --> 00:43:04.016 A:middle
with that serial number.

787
00:43:04.316 --> 00:43:06.356 A:middle
You can go directly to
the source of truth,

788
00:43:06.356 --> 00:43:09.406 A:middle
your gift card services and
say, "Hey, what's the value?"

789
00:43:10.966 --> 00:43:13.596 A:middle
One last conversation with your
database, pretty cool, right?

790
00:43:15.036 --> 00:43:19.406 A:middle
So, take your authentication
token and remember that message

791
00:43:19.406 --> 00:43:20.776 A:middle
that I said, just
pick a message.

792
00:43:21.776 --> 00:43:24.506 A:middle
Well, pick the gift card
number, pick the pin.

793
00:43:24.826 --> 00:43:26.536 A:middle
Pick something that's
relevant to you.

794
00:43:26.536 --> 00:43:27.926 A:middle
It could be a product number.

795
00:43:28.326 --> 00:43:30.336 A:middle
It could be the URL
for your image strip,

796
00:43:30.336 --> 00:43:33.506 A:middle
so if you're building
different passes,

797
00:43:33.596 --> 00:43:36.006 A:middle
if you're building different
passes with different images,

798
00:43:36.176 --> 00:43:40.826 A:middle
you can actually embed the image
URL inside the authentication

799
00:43:40.826 --> 00:43:41.666 A:middle
token, so you don't have

800
00:43:41.666 --> 00:43:45.056 A:middle
to check your database
what image is associated

801
00:43:45.056 --> 00:43:47.216 A:middle
with that pass.

802
00:43:47.216 --> 00:43:49.306 A:middle
It's kind of cool.

803
00:43:49.516 --> 00:43:52.426 A:middle
OK. So, I said some other things
you can embed important dates

804
00:43:52.426 --> 00:43:56.296 A:middle
like expiriees in your
top 10 nearest location,

805
00:43:56.296 --> 00:43:59.376 A:middle
so I don't actually-- once I've
gotten the 10 nearest locations

806
00:43:59.376 --> 00:44:01.876 A:middle
for a pass, I never check
my Location Services again

807
00:44:02.406 --> 00:44:06.256 A:middle
because I have it there.

808
00:44:06.436 --> 00:44:09.826 A:middle
Four, distinguish
test and production.

809
00:44:11.316 --> 00:44:12.936 A:middle
This actually happened to us.

810
00:44:13.446 --> 00:44:16.886 A:middle
We're building in QA
our test environment

811
00:44:16.886 --> 00:44:20.436 A:middle
and we have Quality
Assurance is helping us out

812
00:44:20.436 --> 00:44:22.286 A:middle
and they're building
pass after pass,

813
00:44:22.286 --> 00:44:25.976 A:middle
every permutation you could
imagine, and someone said,

814
00:44:25.976 --> 00:44:28.876 A:middle
"what happens if we took
these test passes to a store?

815
00:44:28.876 --> 00:44:31.746 A:middle
They sure look real" and
in fact, they are real

816
00:44:31.746 --> 00:44:35.126 A:middle
because we signed them with
our pass type identifier

817
00:44:35.126 --> 00:44:36.556 A:middle
and the certificate we had.

818
00:44:36.616 --> 00:44:38.516 A:middle
So, we had to rethink that.

819
00:44:38.516 --> 00:44:41.656 A:middle
So, what you can do is take
that pass type identifier

820
00:44:41.656 --> 00:44:43.396 A:middle
that you embed in the pass.json

821
00:44:43.956 --> 00:44:49.596 A:middle
and you can create a new
pass identifier and test,

822
00:44:49.596 --> 00:44:51.386 A:middle
and just have a different
one for production.

823
00:44:52.026 --> 00:44:53.616 A:middle
Now, if you have
a companion app,

824
00:44:53.616 --> 00:44:55.876 A:middle
make sure your companion
app can work with both--

825
00:44:56.056 --> 00:44:57.986 A:middle
is entitled to work
with both of these,

826
00:44:57.986 --> 00:45:02.546 A:middle
but keeping the pass type
identifier, will make it so that

827
00:45:02.546 --> 00:45:05.276 A:middle
if somebody walks into your
store with a different pass

828
00:45:05.906 --> 00:45:08.986 A:middle
with the test pass, your
point of sale device

829
00:45:08.986 --> 00:45:12.136 A:middle
or whatever you're using to
redeem it can first check, "hey,

830
00:45:12.296 --> 00:45:16.426 A:middle
do I recognize this pass type
identifier" nicely say, "Hey,

831
00:45:16.426 --> 00:45:17.386 A:middle
you're using a test pass.

832
00:45:17.426 --> 00:45:18.596 A:middle
This is not going to work."

833
00:45:19.696 --> 00:45:23.026 A:middle
Very easy way to
distinguish between the two.

834
00:45:23.656 --> 00:45:28.086 A:middle
OK. Building and debug ability.

835
00:45:28.756 --> 00:45:32.546 A:middle
If something goes wrong in prod,

836
00:45:33.716 --> 00:45:36.676 A:middle
in fact when something
goes wrong in production,

837
00:45:37.966 --> 00:45:39.696 A:middle
how are you going to
find out went wrong?

838
00:45:41.176 --> 00:45:44.456 A:middle
This is a perfect example, I
get a text from a friend of mine

839
00:45:44.456 --> 00:45:46.946 A:middle
and they said, "Hey, I
walked by the Apple Store

840
00:45:47.306 --> 00:45:50.656 A:middle
and it didn't tell me that
Apple Store was right there."

841
00:45:51.576 --> 00:45:53.296 A:middle
So, I find out their
serial number,

842
00:45:53.646 --> 00:45:57.086 A:middle
and how do I really know what
were the 10 locations embedded

843
00:45:57.086 --> 00:45:57.496 A:middle
in their pass?

844
00:45:58.476 --> 00:46:01.406 A:middle
Well, if you planned
for it, you can make it

845
<HTML><HEAD>
<TITLE>Request Timeout</TITLE>
</HEAD><BODY>
<H1>Request Timeout</H1>
The server timed out while waiting for the browser's request.<P>
Reference&#32;&#35;2&#46;c6524817&#46;1373787862&#46;0
</BODY></HTML>
WEBVTT
X-TIMESTAMP-MAP=MPEGTS:181083,LOCAL:00:00:00.000

846
00:46:59.916 --> 00:47:07.556 A:middle
we had kind of the easy, the
intermediate, and the advanced.

847
00:47:08.006 --> 00:47:10.326 A:middle
Today, we talked about
Apple Store gift card,

848
00:47:10.646 --> 00:47:12.826 A:middle
we pulled that curtain
back a little bit for you,

849
00:47:13.046 --> 00:47:15.596 A:middle
showed you what we
did, why we did it,

850
00:47:16.946 --> 00:47:20.806 A:middle
leveraging existing
systems, 4 interfaces, right,

851
00:47:22.086 --> 00:47:26.576 A:middle
obtaining the pass, your source
of truth, redeeming the pass

852
00:47:27.386 --> 00:47:28.456 A:middle
and the callback update.

853
00:47:29.836 --> 00:47:32.486 A:middle
Determining complexity, we
went through some facets

854
00:47:32.976 --> 00:47:36.346 A:middle
that allowed you to
measure the level of effort.

855
00:47:36.776 --> 00:47:38.966 A:middle
Basically, you can go back
to your bosses and say,

856
00:47:39.126 --> 00:47:40.436 A:middle
"Hey, I thought about this.

857
00:47:40.776 --> 00:47:42.126 A:middle
I've looked at the Ecosystem.

858
00:47:42.376 --> 00:47:44.026 A:middle
I know the facets
that I need to think

859
00:47:44.026 --> 00:47:45.746 A:middle
about and we can do it too.

860
00:47:45.746 --> 00:47:46.726 A:middle
We can have a pass too."

861
00:47:46.726 --> 00:47:49.016 A:middle
And then some web services tips

862
00:47:49.016 --> 00:47:51.426 A:middle
and tricks, those
are all online.

863
00:47:51.426 --> 00:47:52.706 A:middle
You can go back through them.

864
00:47:53.016 --> 00:47:54.756 A:middle
Read them, understand them more.

865
00:47:56.976 --> 00:47:59.866 A:middle
Paul Marcos, he does
a lot of this for you.

866
00:47:59.866 --> 00:48:01.526 A:middle
He helps us prepare.

867
00:48:01.686 --> 00:48:03.976 A:middle
He's our evangelist,
great access

868
00:48:04.016 --> 00:48:05.846 A:middle
or he has great information,

869
00:48:05.846 --> 00:48:07.686 A:middle
so if you have any
questions, contact him.

870
00:48:08.386 --> 00:48:10.086 A:middle
There's documentation online.

871
00:48:10.816 --> 00:48:14.016 A:middle
In addition, if you missed
it earlier on the What's New

872
00:48:14.016 --> 00:48:15.986 A:middle
in Passbook, it's recorded.

873
00:48:15.986 --> 00:48:16.836 A:middle
So, check that out.

874
00:48:16.966 --> 00:48:21.176 A:middle
I want to call out
Harnessing iOS to Create Magic

875
00:48:21.176 --> 00:48:22.886 A:middle
in Your Apps specifically.

876
00:48:23.476 --> 00:48:26.416 A:middle
This session as well
as the next session

877
00:48:26.416 --> 00:48:30.036 A:middle
and especially the
next session is again

878
00:48:30.036 --> 00:48:33.116 A:middle
about using standard
iOS technologies,

879
00:48:33.326 --> 00:48:35.036 A:middle
kind of as an external
developer,

880
00:48:35.036 --> 00:48:39.266 A:middle
but using those technologies to
enrich the users' experiences.

881
00:48:40.336 --> 00:48:42.736 A:middle
So, they do some really
basic easy things,

882
00:48:43.226 --> 00:48:45.336 A:middle
but it just changes
the life of your apps

883
00:48:46.256 --> 00:48:47.636 A:middle
from an external standpoint.

884
00:48:48.136 --> 00:48:50.156 A:middle
Thank you so much
for joining us.

885
00:48:50.656 --> 00:49:04.850 A:middle
[Applause]

